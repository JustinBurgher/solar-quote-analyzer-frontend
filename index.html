<!-- Integrated Solar Truth AI Tool -->
<div class="bg-white rounded-xl p-6 shadow-lg">
    <!-- Tab Navigation -->
    <div class="flex border-b border-gray-200 mb-6">
        <button class="tab-button active px-6 py-3 font-medium rounded-t-lg" onclick="switchTab('manual')">
            Manual Entry
        </button>
        <button class="tab-button px-6 py-3 font-medium rounded-t-lg ml-2" onclick="switchTab('pdf')">
            PDF Upload
        </button>
    </div>

    <!-- Manual Entry Tab -->
    <div id="manual-tab" class="tab-content active">
        <form id="quoteForm" class="space-y-6">
            <!-- System Size Selection -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-3">System Size (kW)</label>
                <div class="grid grid-cols-4 gap-3 mb-3">
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(2)">2kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(3)">3kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(4)">4kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(5)">5kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(6)">6kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(8)">8kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectSystemSize(10)">10kW</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectCustomSystemSize()">Other</button>
                </div>
                <div id="customSystemSize" class="custom-input">
                    <input type="number" step="0.1" placeholder="Enter system size (kW)" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
            </div>

            <!-- Panel Output Selection -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-3">Panel Output (W)</label>
                <div class="grid grid-cols-3 gap-3 mb-3">
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectPanelOutput(300)">300W</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectPanelOutput(350)">350W</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectPanelOutput(400)">400W</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectPanelOutput(450)">450W</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectPanelOutput(500)">500W</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectPanelOutput(550)">550W</button>
                    <button type="button" class="size-button px-4 py-2 rounded-lg text-sm font-medium" onclick="selectCustomPanelOutput()">Other</button>
                </div>
                <div id="customPanelOutput" class="custom-input">
                    <input type="number" placeholder="Enter panel output (W)" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
            </div>

            <!-- Panel Brand -->
            <div>
                <label for="panelBrand" class="block text-sm font-medium text-gray-700 mb-1">Panel Brand</label>
                <select id="panelBrand" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                    <option value="">Select panel brand</option>
                    <option value="Longi">Longi</option>
                    <option value="Jinko Solar">Jinko Solar</option>
                    <option value="Trina Solar">Trina Solar</option>
                    <option value="Canadian Solar">Canadian Solar</option>
                    <option value="SunPower">SunPower</option>
                    <option value="REC">REC</option>
                    <option value="Other (specify)">Other (specify)</option>
                </select>
                <div id="customPanelBrand" class="custom-input mt-2">
                    <input type="text" placeholder="Enter panel brand" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
                </div>
            </div>

            <!-- Total Price -->
            <div>
                <label for="totalPrice" class="block text-sm font-medium text-gray-700 mb-1">Total Price (Â£)</label>
                <input type="number" id="totalPrice" placeholder="e.g. 9500" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500">
            </div>

            <!-- Battery Section -->
            <div>
                <label for="hasBattery" class="block text-sm font-medium text-gray-700 mb-1">Battery Included?</label>
                <select id="hasBattery" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500" onchange="toggleBatterySection()">
                    <option value="no">No Battery</option>
                    <option value="yes">Yes, Battery Included</option>
                </select>
            </div>

            <!-- Analyze Button -->
            <button type="button" onclick="analyzeQuote()" class="w-full bg-teal-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-teal-700 transition-colors">
                Analyze My Quote
            </button>
        </form>
    </div>

    <!-- PDF Upload Tab -->
    <div id="pdf-tab" class="tab-content">
        <div class="text-center py-12">
            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="text-2xl">ðŸ“„</span>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 mb-4">Upload Your Solar Quote</h3>
            <p class="text-gray-600 mb-6">
                Upload your PDF quote for automatic analysis (Coming Soon)
            </p>
            <input type="file" accept=".pdf" class="hidden" id="pdfUpload">
            <label for="pdfUpload" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors cursor-pointer inline-block">
                Choose PDF File
            </label>
        </div>
    </div>

    <!-- Results Section -->
    <div id="results" class="hidden mt-8 p-6 bg-gray-50 rounded-lg">
        <h3 class="text-xl font-bold text-gray-900 mb-4">Analysis Results</h3>
        <div id="analysisResults"></div>
    </div>
</div>

<!-- Add the JavaScript -->
<script>
    let selectedSystemSize = null;
    let selectedPanelOutput = null;

    function switchTab(tab) {
        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
        
        // Show selected tab
        document.getElementById(tab + '-tab').classList.add('active');
        event.target.classList.add('active');
    }

    function selectSystemSize(size) {
        selectedSystemSize = size;
        document.querySelectorAll('.size-button').forEach(btn => btn.classList.remove('selected'));
        event.target.classList.add('selected');
        document.getElementById('customSystemSize').classList.remove('active');
    }

    function selectCustomSystemSize() {
        document.querySelectorAll('.size-button').forEach(btn => btn.classList.remove('selected'));
        event.target.classList.add('selected');
        document.getElementById('customSystemSize').classList.add('active');
    }

    function selectPanelOutput(output) {
        selectedPanelOutput = output;
        document.querySelectorAll('.size-button').forEach(btn => btn.classList.remove('selected'));
        event.target.classList.add('selected');
        document.getElementById('customPanelOutput').classList.remove('active');
    }

    function selectCustomPanelOutput() {
        document.querySelectorAll('.size-button').forEach(btn => btn.classList.remove('selected'));
        event.target.classList.add('selected');
        document.getElementById('customPanelOutput').classList.add('active');
    }

    function toggleBatterySection() {
        const hasBattery = document.getElementById('hasBattery').value;
        const batterySection = document.getElementById('batterySection');
        if (hasBattery === 'yes') {
            batterySection?.classList.remove('hidden');
        } else {
            batterySection?.classList.add('hidden');
        }
    }

    function analyzeQuote() {
        // Get form data
        const systemSize = selectedSystemSize || document.querySelector('#customSystemSize input')?.value;
        const panelOutput = selectedPanelOutput || document.querySelector('#customPanelOutput input')?.value;
        const panelBrand = document.getElementById('panelBrand').value;
        const totalPrice = document.getElementById('totalPrice').value;

        // Basic validation
        if (!systemSize || !panelOutput || !panelBrand || !totalPrice) {
            alert('Please fill in all required fields');
            return;
        }

        // Show results
        document.getElementById('results').classList.remove('hidden');
        document.getElementById('analysisResults').innerHTML = `
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">System Overview</h4>
                    <p><strong>Size:</strong> ${systemSize}kW</p>
                    <p><strong>Panels:</strong> ${panelBrand} ${panelOutput}W</p>
                    <p><strong>Total Price:</strong> Â£${totalPrice}</p>
                </div>
                <div class="bg-white p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">Quick Analysis</h4>
                    <p class="text-green-600"><strong>âœ“ Analysis Complete</strong></p>
                    <p>Price per kW: Â£${(totalPrice/systemSize).toFixed(0)}</p>
                    <p>Panel Quality: ${getPanelQuality(panelBrand)}</p>
                </div>
            </div>
        `;
    }

    function getPanelQuality(brand) {
        const excellentBrands = ['SunPower', 'REC', 'Longi'];
        const goodBrands = ['Jinko Solar', 'Trina Solar', 'Canadian Solar'];
        
        if (excellentBrands.includes(brand)) return 'Excellent';
        if (goodBrands.includes(brand)) return 'Good';
        return 'Research Needed';
    }
</script>

<!-- Add the CSS -->
<style>
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .tab-button.active { background-color: #0d9488; color: white; }
    .tab-button { background-color: #f3f4f6; color: #374151; }
    .size-button { 
        transition: all 0.2s; 
        border: 2px solid #e5e7eb;
    }
    .size-button:hover { 
        border-color: #0d9488; 
        background-color: #f0fdfa;
    }
    .size-button.selected { 
        background-color: #0d9488; 
        color: white; 
        border-color: #0d9488;
    }
    .custom-input { display: none; }
    .custom-input.active { display: block; }
</style>
