<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Truth AI - Don't Get Ripped Off on Solar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hero-gradient {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%);
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { background-color: #3b82f6; color: white; }
        .tab-button { background-color: #f8fafc; color: #475569; }
        .size-button { 
            transition: all 0.2s; 
            border: 2px solid #e2e8f0;
            background-color: #ffffff;
        }
        .size-button:hover { 
            border-color: #3b82f6; 
            background-color: #eff6ff;
        }
        .size-button.selected { 
            background-color: #3b82f6; 
            color: white; 
            border-color: #3b82f6;
        }
        .custom-input { display: none; }
        .custom-input.active { display: block; }
        .battery-models { display: none; }
        .battery-models.active { display: block; }
        .consultation-step { display: none; }
        .consultation-step.active { display: block; }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .consultation-option {
            transition: all 0.2s;
            cursor: pointer;
        }
        .consultation-option:hover {
            border-color: #3b82f6 !important;
            background-color: #eff6ff !important;
        }
        .consultation-option.selected {
            border-color: #3b82f6 !important;
            background-color: #eff6ff !important;
        }
        .recommendation-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.2s;
        }
        .recommendation-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .confidence-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-block;
        }
        .insight-card {
            border-left: 4px solid #f59e0b;
            background: #fffbeb;
        }
        .tips-card {
            border-left: 4px solid #8b5cf6;
            background: #f5f3ff;
        }
        .steps-card {
            border-left: 4px solid #3b82f6;
            background: #eff6ff;
        }
        .system-icon {
            width: 48px;
            height: 48px;
            background: #3b82f6;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
        .hidden { display: none !important; }
        .payback-toggle {
            margin-top: 8px;
        }
        .payback-button {
            background: #f1f5f9;
            border: 1px solid #cbd5e1;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .payback-button:hover {
            background: #e2e8f0;
        }
        .payback-explanation {
            font-size: 12px;
            color: #64748b;
            margin-top: 4px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mr-3">
                        <span class="text-white font-bold text-lg">‚òÄ</span>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-900">Solar Truth AI</h1>
                </div>
                <nav class="hidden md:flex space-x-8">
                    <a href="#problem" class="text-gray-600 hover:text-gray-900">The Problem</a>
                    <a href="#solution" class="text-gray-600 hover:text-gray-900">Our Solution</a>
                    <a href="#consultation" class="text-gray-600 hover:text-gray-900">Free Analysis</a>
                    <a href="#contact" class="text-gray-600 hover:text-gray-900">Contact</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-gradient text-white py-20">
        <div class="max-w-4xl mx-auto text-center px-4">
            <h1 class="text-5xl font-bold mb-6">Don't Get Ripped Off on Solar</h1>
            <p class="text-xl mb-8 opacity-90">UK homeowners lose thousands on overpriced solar quotes with poor quality panels. Our AI analyzes your quotes in seconds to reveal the truth.</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button onclick="scrollToConsultation()" class="bg-white text-blue-600 px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition">
                    Find Out What You Need FREE
                </button>
                <button onclick="scrollToAnalyzer()" class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-blue-600 transition">
                    Analyze My Quote FREE
                </button>
            </div>
        </div>
    </section>

    <!-- Problem Section -->
    <section id="problem" class="py-16 bg-white">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">The Solar Industry Has a Problem</h2>
                <p class="text-xl text-gray-600">Most homeowners have no idea if they're getting a good deal on solar. Unscrupulous installers take advantage of this knowledge gap.</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="text-6xl mb-4">üí∏</div>
                    <h3 class="text-xl font-semibold mb-3">Overpriced Quotes</h3>
                    <p class="text-gray-600">Many installers charge 20-40% above market rate, knowing customers can't easily compare.</p>
                </div>
                <div class="text-center">
                    <div class="text-6xl mb-4">üìâ</div>
                    <h3 class="text-xl font-semibold mb-3">Poor Quality Panels</h3>
                    <p class="text-gray-600">Cheap, low-efficiency panels that produce less energy and degrade faster than premium options.</p>
                </div>
                <div class="text-center">
                    <div class="text-6xl mb-4">ü§∑</div>
                    <h3 class="text-xl font-semibold mb-3">No Way to Compare</h3>
                    <p class="text-gray-600">Technical jargon and complex specifications make it impossible for homeowners to evaluate quotes.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Solution Section -->
    <section id="solution" class="py-16 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Introducing Solar Truth AI</h2>
                <p class="text-xl text-gray-600">The UK's first AI-powered solar quote analyzer. Get expert-level analysis of your quotes in seconds, not days.</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div class="space-y-8">
                    <div class="flex items-start">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4 flex-shrink-0">
                            <span class="text-blue-600 text-xl">üîç</span>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">Instant Quote Analysis</h3>
                            <p class="text-gray-600">Upload your quote or enter details manually. Our AI analyzes panel quality, pricing, and system specifications in seconds.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4 flex-shrink-0">
                            <span class="text-blue-600 text-xl">üéØ</span>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">UK Market Intelligence</h3>
                            <p class="text-gray-600">Real UK panel brands, current market prices, and quality ratings from actual wholesale suppliers.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4 flex-shrink-0">
                            <span class="text-blue-600 text-xl">üí°</span>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">Actionable Recommendations</h3>
                            <p class="text-gray-600">Get specific advice on what to negotiate, which panels to upgrade to, and red flags to watch out for.</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="font-semibold text-gray-900">Sample Analysis Result</h4>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">‚úÖ Great Quote Detected!</span>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Panel Quality:</span>
                            <span class="font-semibold text-green-600">Excellent</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Price Rating:</span>
                            <span class="font-semibold text-blue-600">Fair Value</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Overall Score:</span>
                            <span class="font-semibold text-green-600">9/10</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- System Sizing Consultation -->
    <section id="consultation" class="py-16 bg-white">
        <div class="max-w-4xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">What Solar System Do You Need?</h2>
                <p class="text-xl text-gray-600 mb-8">Answer 15 quick questions to get your personalized recommendation</p>
                
                <!-- Progress Bar -->
                <div class="w-full bg-gray-200 rounded-full h-3 mb-8">
                    <div id="progress-bar" class="progress-bar bg-blue-600 h-3 rounded-full" style="width: 6.67%"></div>
                </div>
                <div id="progress-text" class="text-sm text-gray-600 mb-8">Question 1 of 15</div>
            </div>

            <!-- Consultation Questions Container -->
            <div id="consultation-container" class="bg-white rounded-lg shadow-lg p-8">
                
                <!-- Question 1: Property Type -->
                <div class="consultation-step active" data-step="1">
                    <h4 class="text-2xl font-semibold mb-6">What type of property do you live in?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-6 text-center" data-value="detached" onclick="selectOption(this, 'propertyType', 'detached')">
                            <div class="text-4xl mb-3">üè†</div>
                            <h5 class="font-semibold">Detached House</h5>
                            <p class="text-sm text-gray-600">Standalone property</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-6 text-center" data-value="semi-detached" onclick="selectOption(this, 'propertyType', 'semi-detached')">
                            <div class="text-4xl mb-3">üèòÔ∏è</div>
                            <h5 class="font-semibold">Semi-Detached</h5>
                            <p class="text-sm text-gray-600">Joined to one neighbor</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-6 text-center" data-value="terraced" onclick="selectOption(this, 'propertyType', 'terraced')">
                            <div class="text-4xl mb-3">üèòÔ∏è</div>
                            <h5 class="font-semibold">Terraced House</h5>
                            <p class="text-sm text-gray-600">Row of connected houses</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-6 text-center" data-value="bungalow" onclick="selectOption(this, 'propertyType', 'bungalow')">
                            <div class="text-4xl mb-3">üè°</div>
                            <h5 class="font-semibold">Bungalow</h5>
                            <p class="text-sm text-gray-600">Single-story home</p>
                        </div>
                    </div>
                </div>

                <!-- Question 2: Bedrooms -->
                <div class="consultation-step" data-step="2">
                    <h4 class="text-2xl font-semibold mb-6">How many bedrooms does your property have?</h4>
                    <div class="grid grid-cols-4 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="1-2" onclick="selectOption(this, 'bedrooms', '1-2')">
                            <h5 class="font-semibold">1-2</h5>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="3" onclick="selectOption(this, 'bedrooms', '3')">
                            <h5 class="font-semibold">3</h5>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="4" onclick="selectOption(this, 'bedrooms', '4')">
                            <h5 class="font-semibold">4</h5>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="5+" onclick="selectOption(this, 'bedrooms', '5+')">
                            <h5 class="font-semibold">5+</h5>
                        </div>
                    </div>
                </div>

                <!-- Question 3: Occupation -->
                <div class="consultation-step" data-step="3">
                    <h4 class="text-2xl font-semibold mb-6">What best describes your work situation?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="healthcare-worker" onclick="selectOption(this, 'occupation', 'healthcare-worker')">
                            <div class="text-3xl mb-2">üë©‚Äç‚öïÔ∏è</div>
                            <h5 class="font-semibold">Healthcare Worker</h5>
                            <p class="text-sm text-gray-600">NHS, private healthcare</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="teacher-educator" onclick="selectOption(this, 'occupation', 'teacher-educator')">
                            <div class="text-3xl mb-2">üë®‚Äçüè´</div>
                            <h5 class="font-semibold">Teacher/Educator</h5>
                            <p class="text-sm text-gray-600">Schools, universities</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="office-worker" onclick="selectOption(this, 'occupation', 'office-worker')">
                            <div class="text-3xl mb-2">üíº</div>
                            <h5 class="font-semibold">Office Worker</h5>
                            <p class="text-sm text-gray-600">Standard 9-5 job</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="shift-worker" onclick="selectOption(this, 'occupation', 'shift-worker')">
                            <div class="text-3xl mb-2">üåô</div>
                            <h5 class="font-semibold">Shift Worker</h5>
                            <p class="text-sm text-gray-600">Rotating shifts, nights</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="work-from-home" onclick="selectOption(this, 'occupation', 'work-from-home')">
                            <div class="text-3xl mb-2">üè†</div>
                            <h5 class="font-semibold">Work from Home</h5>
                            <p class="text-sm text-gray-600">Remote worker</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="self-employed" onclick="selectOption(this, 'occupation', 'self-employed')">
                            <div class="text-3xl mb-2">üë®‚Äçüíº</div>
                            <h5 class="font-semibold">Self-Employed</h5>
                            <p class="text-sm text-gray-600">Own business</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="retired" onclick="selectOption(this, 'occupation', 'retired')">
                            <div class="text-3xl mb-2">üë¥</div>
                            <h5 class="font-semibold">Retired</h5>
                            <p class="text-sm text-gray-600">No longer working</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="other" onclick="selectOption(this, 'occupation', 'other')">
                            <div class="text-3xl mb-2">üë§</div>
                            <h5 class="font-semibold">Other</h5>
                            <p class="text-sm text-gray-600">Different situation</p>
                        </div>
                    </div>
                </div>

                <!-- Question 4: Work Schedule -->
                <div class="consultation-step" data-step="4">
                    <h4 class="text-2xl font-semibold mb-6">What's your typical work schedule?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="standard-days" onclick="selectOption(this, 'workSchedule', 'standard-days')">
                            <h5 class="font-semibold">Standard Days (9am-5pm)</h5>
                            <p class="text-sm text-gray-600">Regular office hours</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="shift-rotating" onclick="selectOption(this, 'workSchedule', 'shift-rotating')">
                            <h5 class="font-semibold">Shift Work - Rotating</h5>
                            <p class="text-sm text-gray-600">Days, nights, weekends</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="work-from-home" onclick="selectOption(this, 'workSchedule', 'work-from-home')">
                            <h5 class="font-semibold">Work from Home</h5>
                            <p class="text-sm text-gray-600">Mostly at home</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="retired" onclick="selectOption(this, 'workSchedule', 'retired')">
                            <h5 class="font-semibold">Retired/Flexible</h5>
                            <p class="text-sm text-gray-600">No fixed schedule</p>
                        </div>
                    </div>
                </div>

                <!-- Question 5: Home During Day -->
                <div class="consultation-step" data-step="5">
                    <h4 class="text-2xl font-semibold mb-6">How often are you home during the day (9am-4pm)?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="rarely" onclick="selectOption(this, 'homeDuringDay', 'rarely')">
                            <h5 class="font-semibold">Rarely</h5>
                            <p class="text-sm text-gray-600">Almost always out</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="sometimes" onclick="selectOption(this, 'homeDuringDay', 'sometimes')">
                            <h5 class="font-semibold">Sometimes</h5>
                            <p class="text-sm text-gray-600">1-2 days per week</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="often" onclick="selectOption(this, 'homeDuringDay', 'often')">
                            <h5 class="font-semibold">Often</h5>
                            <p class="text-sm text-gray-600">3-4 days per week</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="always" onclick="selectOption(this, 'homeDuringDay', 'always')">
                            <h5 class="font-semibold">Always</h5>
                            <p class="text-sm text-gray-600">Home most days</p>
                        </div>
                    </div>
                </div>

                <!-- Question 6: Household -->
                <div class="consultation-step" data-step="6">
                    <h4 class="text-2xl font-semibold mb-6">Who lives in your household?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="just-me" onclick="selectOption(this, 'household', 'just-me')">
                            <h5 class="font-semibold">Just me</h5>
                            <p class="text-sm text-gray-600">Single occupancy</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="couple-no-children" onclick="selectOption(this, 'household', 'couple-no-children')">
                            <h5 class="font-semibold">Couple, no children</h5>
                            <p class="text-sm text-gray-600">Two adults</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="family-young-children" onclick="selectOption(this, 'household', 'family-young-children')">
                            <h5 class="font-semibold">Family with young children</h5>
                            <p class="text-sm text-gray-600">Children under 12</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="family-teenagers" onclick="selectOption(this, 'household', 'family-teenagers')">
                            <h5 class="font-semibold">Family with teenagers</h5>
                            <p class="text-sm text-gray-600">Children 12+</p>
                        </div>
                    </div>
                </div>

                <!-- Question 7: Monthly Bill -->
                <div class="consultation-step" data-step="7">
                    <h4 class="text-2xl font-semibold mb-6">What's your average monthly electricity bill?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="40-70" onclick="selectOption(this, 'monthlyBill', '40-70')">
                            <h5 class="font-semibold">¬£40 - ¬£70</h5>
                            <p class="text-sm text-gray-600">Low usage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="70-100" onclick="selectOption(this, 'monthlyBill', '70-100')">
                            <h5 class="font-semibold">¬£70 - ¬£100</h5>
                            <p class="text-sm text-gray-600">Average usage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="100-140" onclick="selectOption(this, 'monthlyBill', '100-140')">
                            <h5 class="font-semibold">¬£100 - ¬£140</h5>
                            <p class="text-sm text-gray-600">Higher usage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="140-200" onclick="selectOption(this, 'monthlyBill', '140-200')">
                            <h5 class="font-semibold">¬£140 - ¬£200</h5>
                            <p class="text-sm text-gray-600">High usage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="200+" onclick="selectOption(this, 'monthlyBill', '200+')">
                            <h5 class="font-semibold">¬£200+</h5>
                            <p class="text-sm text-gray-600">Very high usage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="not-sure" onclick="selectOption(this, 'monthlyBill', 'not-sure')">
                            <h5 class="font-semibold">Not sure</h5>
                            <p class="text-sm text-gray-600">Will estimate</p>
                        </div>
                    </div>
                </div>

                <!-- Question 8: EV Plans -->
                <div class="consultation-step" data-step="8">
                    <h4 class="text-2xl font-semibold mb-6">Do you have or plan to get an electric vehicle?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="have-one" onclick="selectOption(this, 'evPlans', 'have-one')">
                            <div class="text-3xl mb-2">üöó</div>
                            <h5 class="font-semibold">Already have one</h5>
                            <p class="text-sm text-gray-600">Currently own EV</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="planning-2-years" onclick="selectOption(this, 'evPlans', 'planning-2-years')">
                            <div class="text-3xl mb-2">üìÖ</div>
                            <h5 class="font-semibold">Planning within 2 years</h5>
                            <p class="text-sm text-gray-600">Definite plans</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="considering-2-5-years" onclick="selectOption(this, 'evPlans', 'considering-2-5-years')">
                            <div class="text-3xl mb-2">ü§î</div>
                            <h5 class="font-semibold">Considering in 2-5 years</h5>
                            <p class="text-sm text-gray-600">Possible future</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="no-plans" onclick="selectOption(this, 'evPlans', 'no-plans')">
                            <div class="text-3xl mb-2">‚õΩ</div>
                            <h5 class="font-semibold">No plans</h5>
                            <p class="text-sm text-gray-600">Sticking with petrol/diesel</p>
                        </div>
                    </div>
                </div>

                <!-- Question 9: Heating System -->
                <div class="consultation-step" data-step="9">
                    <h4 class="text-2xl font-semibold mb-6">What heating system do you currently have?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="gas-boiler" onclick="selectOption(this, 'heatingSystem', 'gas-boiler')">
                            <h5 class="font-semibold">Gas boiler</h5>
                            <p class="text-sm text-gray-600">Traditional heating</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="heat-pump" onclick="selectOption(this, 'heatingSystem', 'heat-pump')">
                            <h5 class="font-semibold">Heat pump</h5>
                            <p class="text-sm text-gray-600">Electric heating</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="electric-heating" onclick="selectOption(this, 'heatingSystem', 'electric-heating')">
                            <h5 class="font-semibold">Electric heating</h5>
                            <p class="text-sm text-gray-600">Storage heaters, etc.</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="other" onclick="selectOption(this, 'heatingSystem', 'other')">
                            <h5 class="font-semibold">Other</h5>
                            <p class="text-sm text-gray-600">Oil, LPG, etc.</p>
                        </div>
                    </div>
                </div>

                <!-- Question 10: Heat Pump Plans -->
                <div class="consultation-step" data-step="10">
                    <h4 class="text-2xl font-semibold mb-6">Are you considering a heat pump in the future?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="within-2-years" onclick="selectOption(this, 'heatPumpPlans', 'within-2-years')">
                            <h5 class="font-semibold">Planning within 2 years</h5>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="within-5-years" onclick="selectOption(this, 'heatPumpPlans', 'within-5-years')">
                            <h5 class="font-semibold">Considering within 5 years</h5>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="considering-unsure" onclick="selectOption(this, 'heatPumpPlans', 'considering-unsure')">
                            <h5 class="font-semibold">Considering but unsure when</h5>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="no-plans" onclick="selectOption(this, 'heatPumpPlans', 'no-plans')">
                            <h5 class="font-semibold">No plans for heat pump</h5>
                        </div>
                    </div>
                </div>

                <!-- Question 11: Primary Goal -->
                <div class="consultation-step" data-step="11">
                    <h4 class="text-2xl font-semibold mb-6">What's your main reason for considering solar?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="save-money" onclick="selectOption(this, 'primaryGoal', 'save-money')">
                            <div class="text-3xl mb-2">üíµ</div>
                            <h5 class="font-semibold">Save money on bills</h5>
                            <p class="text-sm text-gray-600">Reduce monthly costs</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="environmental" onclick="selectOption(this, 'primaryGoal', 'environmental')">
                            <div class="text-3xl mb-2">üå±</div>
                            <h5 class="font-semibold">Environmental impact</h5>
                            <p class="text-sm text-gray-600">Reduce carbon footprint</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="energy-independence" onclick="selectOption(this, 'primaryGoal', 'energy-independence')">
                            <div class="text-3xl mb-2">üîã</div>
                            <h5 class="font-semibold">Energy independence</h5>
                            <p class="text-sm text-gray-600">Generate own power</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="property-value" onclick="selectOption(this, 'primaryGoal', 'property-value')">
                            <div class="text-3xl mb-2">üè†</div>
                            <h5 class="font-semibold">Increase property value</h5>
                            <p class="text-sm text-gray-600">Home investment</p>
                        </div>
                    </div>
                </div>

                <!-- Question 12: Battery Interest -->
                <div class="consultation-step" data-step="12">
                    <h4 class="text-2xl font-semibold mb-6">How important is battery storage to you?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="essential" onclick="selectOption(this, 'batteryInterest', 'essential')">
                            <h5 class="font-semibold">Essential</h5>
                            <p class="text-sm text-gray-600">Must have battery storage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="very-interested" onclick="selectOption(this, 'batteryInterest', 'very-interested')">
                            <h5 class="font-semibold">Very interested</h5>
                            <p class="text-sm text-gray-600">Want battery if budget allows</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="somewhat-interested" onclick="selectOption(this, 'batteryInterest', 'somewhat-interested')">
                            <h5 class="font-semibold">Somewhat interested</h5>
                            <p class="text-sm text-gray-600">Depends on cost/benefit</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="not-interested" onclick="selectOption(this, 'batteryInterest', 'not-interested')">
                            <h5 class="font-semibold">Not interested</h5>
                            <p class="text-sm text-gray-600">Just want solar panels</p>
                        </div>
                    </div>
                </div>

                <!-- Question 13: Roof Orientation -->
                <div class="consultation-step" data-step="13">
                    <h4 class="text-2xl font-semibold mb-6">Which direction does your main roof face?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="south" onclick="selectOption(this, 'roofOrientation', 'south')">
                            <div class="text-3xl mb-2">‚òÄÔ∏è</div>
                            <h5 class="font-semibold">South</h5>
                            <p class="text-sm text-gray-600">Best for solar generation</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="east" onclick="selectOption(this, 'roofOrientation', 'east')">
                            <div class="text-3xl mb-2">üåÖ</div>
                            <h5 class="font-semibold">East</h5>
                            <p class="text-sm text-gray-600">Good morning generation</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="west" onclick="selectOption(this, 'roofOrientation', 'west')">
                            <div class="text-3xl mb-2">üåá</div>
                            <h5 class="font-semibold">West</h5>
                            <p class="text-sm text-gray-600">Good afternoon generation</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="east-west" onclick="selectOption(this, 'roofOrientation', 'east-west')">
                            <div class="text-3xl mb-2">üîÑ</div>
                            <h5 class="font-semibold">East/West</h5>
                            <p class="text-sm text-gray-600">Multiple roof sections</p>
                        </div>
                    </div>
                </div>

                <!-- Question 14: Budget -->
                <div class="consultation-step" data-step="14">
                    <h4 class="text-2xl font-semibold mb-6">What's your budget for solar (including battery if wanted)?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="5000-8000" onclick="selectOption(this, 'budget', '5000-8000')">
                            <h5 class="font-semibold">¬£5,000 - ¬£8,000</h5>
                            <p class="text-sm text-gray-600">Smaller system, value-focused</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="8000-12000" onclick="selectOption(this, 'budget', '8000-12000')">
                            <h5 class="font-semibold">¬£8,000 - ¬£12,000</h5>
                            <p class="text-sm text-gray-600">Medium system</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="12000-18000" onclick="selectOption(this, 'budget', '12000-18000')">
                            <h5 class="font-semibold">¬£12,000 - ¬£18,000</h5>
                            <p class="text-sm text-gray-600">Larger system with battery</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="18000-25000" onclick="selectOption(this, 'budget', '18000-25000')">
                            <h5 class="font-semibold">¬£18,000 - ¬£25,000</h5>
                            <p class="text-sm text-gray-600">Premium system</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="25000+" onclick="selectOption(this, 'budget', '25000+')">
                            <h5 class="font-semibold">¬£25,000+</h5>
                            <p class="text-sm text-gray-600">Maximum system</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="depends-on-payback" onclick="selectOption(this, 'budget', 'depends-on-payback')">
                            <h5 class="font-semibold">Depends on payback</h5>
                            <p class="text-sm text-gray-600">ROI-focused decision</p>
                        </div>
                    </div>
                </div>

                <!-- Question 15: Annual Consumption -->
                <div class="consultation-step" data-step="15">
                    <h4 class="text-2xl font-semibold mb-6">Do you know your annual electricity consumption?</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="under-3000" onclick="selectOption(this, 'annualConsumption', 'under-3000')">
                            <h5 class="font-semibold">Under 3,000 kWh</h5>
                            <p class="text-sm text-gray-600">Low usage household</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="3000-4500" onclick="selectOption(this, 'annualConsumption', '3000-4500')">
                            <h5 class="font-semibold">3,000 - 4,500 kWh</h5>
                            <p class="text-sm text-gray-600">Average household</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="4500-6000" onclick="selectOption(this, 'annualConsumption', '4500-6000')">
                            <h5 class="font-semibold">4,500 - 6,000 kWh</h5>
                            <p class="text-sm text-gray-600">Higher usage</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="6000+" onclick="selectOption(this, 'annualConsumption', '6000+')">
                            <h5 class="font-semibold">6,000+ kWh</h5>
                            <p class="text-sm text-gray-600">High usage household</p>
                        </div>
                        <div class="consultation-option border-2 border-gray-200 rounded-lg p-4 text-center" data-value="not-sure" onclick="selectOption(this, 'annualConsumption', 'not-sure')">
                            <h5 class="font-semibold">Not sure</h5>
                            <p class="text-sm text-gray-600">Will estimate from bill</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between mt-8">
                <button id="prev-btn" onclick="previousQuestion()" class="hidden bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition">
                    Previous
                </button>
                <div></div>
                <button id="next-btn" onclick="nextQuestion()" disabled class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition opacity-50 cursor-not-allowed">
                    Next Question
                </button>
            </div>

            <!-- Results Section -->
            <div id="consultation-results" class="hidden mt-12">
                <div class="text-center mb-8">
                    <h3 class="text-3xl font-bold text-gray-900 mb-4">Your Personalized Solar Recommendation</h3>
                    <div id="confidence-score" class="confidence-badge mb-6">92% Confidence</div>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- System Overview -->
                    <div class="recommendation-card p-6">
                        <div class="flex items-center mb-4">
                            <div class="system-icon mr-4">‚ö°</div>
                            <h4 class="text-xl font-semibold">System Overview</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Solar System Size:</span>
                                <span id="system-size" class="font-semibold">6.5kW</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Battery Storage:</span>
                                <span id="battery-size" class="font-semibold">13.5kWh</span>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Summary -->
                    <div class="recommendation-card p-6">
                        <div class="flex items-center mb-4">
                            <div class="system-icon mr-4" style="background: #10b981;">üí∞</div>
                            <h4 class="text-xl font-semibold">Financial Summary</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Total Cost:</span>
                                <span id="total-cost" class="font-semibold">¬£19,250</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Annual Savings:</span>
                                <span id="annual-savings" class="font-semibold">¬£1,850</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payback Period:</span>
                                <div>
                                    <span id="payback-period" class="font-semibold">10.4 years</span>
                                    <div class="payback-toggle">
                                        <button id="payback-toggle-btn" onclick="togglePaybackInflation()" class="payback-button">
                                            Show with current inflation (7%)
                                        </button>
                                        <div id="payback-explanation" class="payback-explanation">
                                            Based on 3.5% annual energy price increases (standard assumption)
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">25-Year ROI:</span>
                                <span id="roi" class="font-semibold">240%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lifestyle Insights -->
                <div class="recommendation-card insight-card p-6 mt-6">
                    <h4 class="text-xl font-semibold mb-4">Lifestyle Insights</h4>
                    <p id="lifestyle-insight" class="text-gray-700">
                        As a healthcare worker with irregular shifts, your energy usage doesn't align well with solar generation. Your shift work means you need large battery storage for energy flexibility when working nights.
                    </p>
                </div>

                <!-- Optimization Tips -->
                <div class="recommendation-card tips-card p-6 mt-6">
                    <h4 class="text-xl font-semibold mb-4">Optimization Tips</h4>
                    <ul id="optimization-tips" class="space-y-2 text-gray-700">
                        <li>‚Ä¢ Set washing machine and dishwasher to run during sunny days when possible</li>
                        <li>‚Ä¢ Charge devices and run high-energy appliances during peak solar hours (10am-3pm)</li>
                        <li>‚Ä¢ Consider smart home automation to maximize battery efficiency</li>
                    </ul>
                </div>

                <!-- Next Steps -->
                <div class="recommendation-card steps-card p-6 mt-6">
                    <h4 class="text-xl font-semibold mb-4">Next Steps</h4>
                    <ol id="next-steps" class="space-y-2 text-gray-700">
                        <li>1. Get quotes for a 6.5kW system with 13.5kWh battery</li>
                        <li>2. Use our quote analyzer to verify pricing and quality</li>
                        <li>3. Ensure installers are MCS certified and properly insured</li>
                        <li>4. Compare at least 3 quotes before making a decision</li>
                    </ol>
                </div>

                <!-- Call to Action -->
                <div class="text-center mt-8">
                    <button onclick="scrollToAnalyzer()" class="bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold hover:bg-blue-700 transition text-lg">
                        Now Analyze Your Quotes
                    </button>
                    <p class="text-sm text-gray-600 mt-2">Use our quote analyzer to verify any quotes you receive match this recommendation</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Quote Analyzer Section -->
    <section id="analyzer" class="py-16 bg-gray-50">
        <div class="max-w-4xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Analyze Your Solar Quote Now</h2>
                <p class="text-xl text-gray-600">Get instant expert analysis of your solar quote. Takes less than 2 minutes.</p>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-8">
                <!-- Tab Navigation -->
                <div class="flex mb-8 bg-gray-100 rounded-lg p-1">
                    <button class="tab-button flex-1 py-3 px-4 rounded-lg font-semibold transition active" onclick="switchTab('manual')">
                        Manual Entry
                    </button>
                    <button class="tab-button flex-1 py-3 px-4 rounded-lg font-semibold transition" onclick="switchTab('pdf')">
                        PDF Upload
                    </button>
                </div>

                <!-- Manual Entry Tab -->
                <div id="manual-tab" class="tab-content active">
                    <form id="quote-form">
                        <!-- System Size -->
                        <div class="mb-8">
                            <label class="block text-lg font-semibold mb-4">System Size (kW)</label>
                            <div class="grid grid-cols-4 gap-3">
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="2">2kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="3">3kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="4">4kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="5">5kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="6">6kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="8">8kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="10">10kW</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-size="custom">Other</button>
                            </div>
                            <div id="custom-size-input" class="custom-input mt-4">
                                <input type="number" placeholder="Enter custom size (kW)" class="w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                        </div>

                        <!-- Panel Output -->
                        <div class="mb-8">
                            <label class="block text-lg font-semibold mb-4">Panel Output (Watts per panel)</label>
                            <div class="grid grid-cols-4 gap-3">
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="300">300W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="350">350W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="400">400W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="450">450W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="500">500W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="550">550W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="600">600W</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-output="custom-output">Custom</button>
                            </div>
                            <div id="custom-output-input" class="custom-input mt-4">
                                <input type="number" placeholder="Enter custom output (W)" class="w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                        </div>

                        <!-- Panel Brand -->
                        <div class="mb-8">
                            <label class="block text-lg font-semibold mb-4">Panel Brand</label>
                            <select class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="">Select panel brand...</option>
                                <optgroup label="Premium Brands (Excellent)">
                                    <option value="sunpower">SunPower</option>
                                    <option value="panasonic">Panasonic</option>
                                    <option value="lg">LG Solar</option>
                                    <option value="rec">REC Solar</option>
                                </optgroup>
                                <optgroup label="Tier 1 Brands (Very Good)">
                                    <option value="dmegc">DMEGC</option>
                                    <option value="perlight">Perlight</option>
                                    <option value="longi">LONGi Solar</option>
                                    <option value="jinko">Jinko Solar</option>
                                    <option value="trina">Trina Solar</option>
                                    <option value="canadian">Canadian Solar</option>
                                    <option value="ja-solar">JA Solar</option>
                                    <option value="risen">Risen Energy</option>
                                    <option value="aiko">Aiko Solar</option>
                                    <option value="eurener">Eurener</option>
                                </optgroup>
                                <optgroup label="Good Brands">
                                    <option value="qcells">Q CELLS</option>
                                    <option value="solaria">Solaria</option>
                                    <option value="silfab">Silfab Solar</option>
                                    <option value="astronergy">Astronergy</option>
                                    <option value="seraphim">Seraphim</option>
                                </optgroup>
                                <optgroup label="Budget Brands">
                                    <option value="yingli">Yingli Solar</option>
                                    <option value="renesola">ReneSola</option>
                                    <option value="boviet">Boviet Solar</option>
                                </optgroup>
                                <option value="other">Other (specify in notes)</option>
                            </select>
                        </div>

                        <!-- Battery Section -->
                        <div class="mb-8">
                            <label class="block text-lg font-semibold mb-4">Battery Storage</label>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-battery="none">No Battery</button>
                                <button type="button" class="size-button py-3 px-4 rounded-lg font-semibold" data-battery="yes">Include Battery</button>
                            </div>
                            
                            <div id="battery-details" class="battery-models space-y-4">
                                <div>
                                    <label class="block font-semibold mb-2">Battery Brand</label>
                                    <select class="w-full p-3 border border-gray-300 rounded-lg">
                                        <option value="">Select battery brand...</option>
                                        <optgroup label="Premium Brands">
                                            <option value="tesla">Tesla Powerwall</option>
                                            <option value="lg-chem">LG Chem RESU</option>
                                            <option value="sonnen">Sonnen</option>
                                            <option value="enphase">Enphase IQ Battery</option>
                                        </optgroup>
                                        <optgroup label="Popular UK Brands">
                                            <option value="givenergy">GivEnergy</option>
                                            <option value="fox-ess">Fox ESS</option>
                                            <option value="solaredge">SolarEdge</option>
                                            <option value="solax">SolaX</option>
                                            <option value="growatt">Growatt</option>
                                            <option value="huawei">Huawei</option>
                                            <option value="sungrow">Sungrow</option>
                                            <option value="pylontech">Pylontech</option>
                                        </optgroup>
                                        <optgroup label="Other Brands">
                                            <option value="byd">BYD</option>
                                            <option value="alpha-ess">Alpha ESS</option>
                                            <option value="victron">Victron Energy</option>
                                            <option value="moixa">Moixa</option>
                                        </optgroup>
                                        <option value="other-battery">Other (specify in notes)</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block font-semibold mb-2">Battery Capacity (kWh)</label>
                                    <div class="grid grid-cols-4 gap-3">
                                        <button type="button" class="size-button py-2 px-3 rounded-lg font-semibold" data-capacity="5">5kWh</button>
                                        <button type="button" class="size-button py-2 px-3 rounded-lg font-semibold" data-capacity="10">10kWh</button>
                                        <button type="button" class="size-button py-2 px-3 rounded-lg font-semibold" data-capacity="13.5">13.5kWh</button>
                                        <button type="button" class="size-button py-2 px-3 rounded-lg font-semibold" data-capacity="15">15kWh</button>
                                        <button type="button" class="size-button py-2 px-3 rounded-lg font-semibold" data-capacity="20">20kWh</button>
                                        <button type="button" class="size-button py-2 px-3 rounded-lg font-semibold" data-capacity="custom-capacity">Custom</button>
                                    </div>
                                    <div id="custom-capacity-input" class="custom-input mt-4">
                                        <input type="number" placeholder="Enter custom capacity (kWh)" class="w-full p-3 border border-gray-300 rounded-lg">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Total Price -->
                        <div class="mb-8">
                            <label class="block text-lg font-semibold mb-4">Total Price (¬£)</label>
                            <input type="number" placeholder="Enter total quote price" class="w-full p-3 border border-gray-300 rounded-lg">
                        </div>

                        <button type="submit" class="w-full bg-blue-600 text-white py-4 rounded-lg font-semibold hover:bg-blue-700 transition text-lg">
                            Analyze My Quote
                        </button>
                    </form>
                </div>

                <!-- PDF Upload Tab -->
                <div id="pdf-tab" class="tab-content">
                    <div class="text-center py-12">
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-8">
                            <div class="text-4xl mb-4">üìÑ</div>
                            <h3 class="text-xl font-semibold mb-2">Upload Your Solar Quote</h3>
                            <p class="text-gray-600 mb-4">Drag and drop your PDF quote here, or click to browse</p>
                            <input type="file" accept=".pdf" class="hidden" id="pdf-upload">
                            <label for="pdf-upload" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition cursor-pointer">
                                Choose PDF File
                            </label>
                        </div>
                    </div>
                    
                    <button class="w-full bg-blue-600 text-white py-4 rounded-lg font-semibold hover:bg-blue-700 transition text-lg">
                        Analyze PDF Quote
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-6xl mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mr-2">
                            <span class="text-white font-bold">‚òÄ</span>
                        </div>
                        <h3 class="text-xl font-bold">Solar Truth AI</h3>
                    </div>
                    <p class="text-gray-400">Independent solar analysis you can trust. No installer bias, just honest advice.</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Services</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#consultation" class="hover:text-white">System Sizing</a></li>
                        <li><a href="#analyzer" class="hover:text-white">Quote Analysis</a></li>
                        <li><a href="#" class="hover:text-white">Installer Vetting</a></li>
                        <li><a href="#" class="hover:text-white">Performance Monitoring</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Resources</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-white">Solar Guide</a></li>
                        <li><a href="#" class="hover:text-white">Battery Guide</a></li>
                        <li><a href="#" class="hover:text-white">ROI Calculator</a></li>
                        <li><a href="#" class="hover:text-white">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Contact</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li>Email: hello@solartruth.ai</li>
                        <li>Phone: 0800 123 4567</li>
                        <li>Mon-Fri: 9am-6pm</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 Solar Truth AI. All rights reserved. Independent solar analysis for UK homeowners.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentStep = 1;
        const totalSteps = 15;
        let consultationData = {};
        let selectedSystemSize = null;
        let selectedPanelOutput = null;
        let selectedBattery = null;
        let selectedBatteryCapacity = null;
        let currentPaybackInflation = false; // false = 3.5%, true = 7%

        // Initialize the recommendation engine
        const engine = new SolarRecommendationEngine();

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            document.getElementById(`${tab}-tab`).classList.add('active');
        }

        // Consultation functions
        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
            document.getElementById('progress-text').textContent = `Question ${currentStep} of ${totalSteps}`;
        }

        function selectOption(element, questionKey, value) {
            // Remove selection from siblings
            const siblings = element.parentElement.children;
            for (let sibling of siblings) {
                sibling.classList.remove('selected');
            }
            
            // Add selection to clicked element
            element.classList.add('selected');
            
            // Store the value
            consultationData[questionKey] = value;
            
            // Enable next button
            const nextBtn = document.getElementById('next-btn');
            nextBtn.disabled = false;
            nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        }

        function nextQuestion() {
            if (currentStep < totalSteps) {
                // Hide current step
                document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
                
                // Show next step
                currentStep++;
                document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
                
                // Update progress
                updateProgress();
                
                // Show/hide navigation buttons
                document.getElementById('prev-btn').classList.remove('hidden');
                
                // Disable next button until selection is made
                const nextBtn = document.getElementById('next-btn');
                if (currentStep === totalSteps) {
                    nextBtn.textContent = 'Get My Recommendation';
                    nextBtn.onclick = showResults;
                } else {
                    nextBtn.disabled = true;
                    nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
                }
            }
        }

        function previousQuestion() {
            if (currentStep > 1) {
                // Hide current step
                document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
                
                // Show previous step
                currentStep--;
                document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
                
                // Update progress
                updateProgress();
                
                // Hide previous button if at first step
                if (currentStep === 1) {
                    document.getElementById('prev-btn').classList.add('hidden');
                }
                
                // Update next button
                const nextBtn = document.getElementById('next-btn');
                nextBtn.textContent = 'Next Question';
                nextBtn.onclick = nextQuestion;
                nextBtn.disabled = false;
                nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        function showResults() {
            // Hide consultation container
            document.getElementById('consultation-container').style.display = 'none';
            document.querySelector('.flex.justify-between.mt-8').style.display = 'none';
            
            // Generate recommendation using algorithm
            const recommendation = engine.calculateSolarRecommendation(consultationData);
            
            // Display results
            displayRecommendation(recommendation);
            
            // Show results section
            document.getElementById('consultation-results').classList.remove('hidden');
        }

        function displayRecommendation(recommendation) {
            const { system, financials, insights, confidence } = recommendation;
            
            // Update system details
            document.getElementById('system-size').textContent = system.systemSize + 'kW';
            document.getElementById('battery-size').textContent = system.batterySize + 'kWh';
            document.getElementById('confidence-score').textContent = confidence + '% Confidence';
            
            // Update financials
            document.getElementById('total-cost').textContent = '¬£' + financials.systemCost.toLocaleString();
            document.getElementById('annual-savings').textContent = '¬£' + financials.annualSavings.toLocaleString();
            document.getElementById('payback-period').textContent = financials.paybackYears + ' years';
            document.getElementById('roi').textContent = financials.roi + '%';
            
            // Store financials for toggle
            window.currentFinancials = financials;
            
            // Update insights
            document.getElementById('lifestyle-insight').textContent = insights.lifestyleMatch;
            
            // Update optimization tips
            const tipsList = document.getElementById('optimization-tips');
            tipsList.innerHTML = insights.optimizationTips.map(tip => `<li>‚Ä¢ ${tip}</li>`).join('');
            
            // Update next steps
            const stepsList = document.getElementById('next-steps');
            stepsList.innerHTML = insights.nextSteps.map((step, index) => `<li>${index + 1}. ${step}</li>`).join('');
        }

        function togglePaybackInflation() {
            const paybackElement = document.getElementById('payback-period');
            const toggleBtn = document.getElementById('payback-toggle-btn');
            const explanation = document.getElementById('payback-explanation');
            
            if (!currentPaybackInflation) {
                // Switch to 7% inflation
                paybackElement.textContent = window.currentFinancials.paybackYearsCurrentInflation + ' years';
                toggleBtn.textContent = 'Show with standard inflation (3.5%)';
                explanation.textContent = 'Based on 7% annual energy price increases (current UK inflation)';
                currentPaybackInflation = true;
            } else {
                // Switch back to 3.5% inflation
                paybackElement.textContent = window.currentFinancials.paybackYears + ' years';
                toggleBtn.textContent = 'Show with current inflation (7%)';
                explanation.textContent = 'Based on 3.5% annual energy price increases (standard assumption)';
                currentPaybackInflation = false;
            }
        }

        // Quote analyzer functions
        function selectSystemSize(button, size) {
            document.querySelectorAll('[data-size]').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            button.classList.add('selected');
            selectedSystemSize = size;
            
            const customInput = document.getElementById('custom-size-input');
            if (size === 'custom') {
                customInput.classList.add('active');
            } else {
                customInput.classList.remove('active');
            }
        }

        function selectPanelOutput(button, output) {
            document.querySelectorAll('[data-output]').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            button.classList.add('selected');
            selectedPanelOutput = output;
            
            const customInput = document.getElementById('custom-output-input');
            if (output === 'custom-output') {
                customInput.classList.add('active');
            } else {
                customInput.classList.remove('active');
            }
        }

        function selectBattery(button, battery) {
            document.querySelectorAll('[data-battery]').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            button.classList.add('selected');
            selectedBattery = battery;
            
            const batteryDetails = document.getElementById('battery-details');
            if (battery === 'yes') {
                batteryDetails.classList.add('active');
            } else {
                batteryDetails.classList.remove('active');
            }
        }

        function selectBatteryCapacity(button, capacity) {
            document.querySelectorAll('[data-capacity]').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            button.classList.add('selected');
            selectedBatteryCapacity = capacity;
            
            const customInput = document.getElementById('custom-capacity-input');
            if (capacity === 'custom-capacity') {
                customInput.classList.add('active');
            } else {
                customInput.classList.remove('active');
            }
        }

        // Add event listeners for quote analyzer
        document.addEventListener('DOMContentLoaded', function() {
            // System size buttons
            document.querySelectorAll('[data-size]').forEach(button => {
                button.addEventListener('click', function() {
                    selectSystemSize(this, this.dataset.size);
                });
            });
            
            // Panel output buttons
            document.querySelectorAll('[data-output]').forEach(button => {
                button.addEventListener('click', function() {
                    selectPanelOutput(this, this.dataset.output);
                });
            });
            
            // Battery buttons
            document.querySelectorAll('[data-battery]').forEach(button => {
                button.addEventListener('click', function() {
                    selectBattery(this, this.dataset.battery);
                });
            });
            
            // Battery capacity buttons
            document.querySelectorAll('[data-capacity]').forEach(button => {
                button.addEventListener('click', function() {
                    selectBatteryCapacity(this, this.dataset.capacity);
                });
            });
        });

        // Scroll functions
        function scrollToConsultation() {
            document.getElementById('consultation').scrollIntoView({ behavior: 'smooth' });
        }

        function scrollToAnalyzer() {
            document.getElementById('analyzer').scrollIntoView({ behavior: 'smooth' });
        }

        /**
         * FIXED Solar Truth AI Algorithm with Correct UK Inflation Rates
         */
        class SolarRecommendationEngine {
            constructor() {
                // Base constants for calculations
                this.constants = {
                    // Solar generation per kW in UK (kWh/year)
                    solarGenerationPerKW: 900,
                    
                    // Costs per kW and kWh
                    systemCostPerKW: 1300,
                    batteryCostPerKWh: 800,
                    
                    // Energy prices (current UK rates)
                    electricityPrice: 0.30, // ¬£ per kWh
                    exportPrice: 0.05,      // ¬£ per kWh
                    
                    // FIXED: Inflation rates for payback calculation
                    inflationRateStandard: 0.035,  // 3.5% - standard quote assumption
                    inflationRateCurrent: 0.07,    // 7% - current UK inflation
                    
                    // Efficiency factors
                    systemEfficiency: 0.85,
                    batteryEfficiency: 0.90,
                    
                    // Roof orientation multipliers
                    roofMultipliers: {
                        'south': 1.0,
                        'east': 0.85,
                        'west': 0.85,
                        'east-west': 0.90,
                        'north': 0.60,
                        'multiple': 0.85
                    }
                };
                
                // Occupation-based energy patterns
                this.occupationProfiles = {
                    'healthcare': {
                        batteryMultiplier: 2.5,
                        usageVariability: 'high',
                        solarAlignment: 'poor',
                        description: 'Irregular shifts require large battery for flexibility'
                    },
                    'teacher': {
                        batteryMultiplier: 1.5,
                        usageVariability: 'medium',
                        solarAlignment: 'good',
                        description: 'School schedule aligns well with solar, battery helps during holidays'
                    },
                    'office': {
                        batteryMultiplier: 2.0,
                        usageVariability: 'low',
                        solarAlignment: 'poor',
                        description: 'Away during peak solar hours, battery essential for evening usage'
                    },
                    'shift': {
                        batteryMultiplier: 3.0,
                        usageVariability: 'very-high',
                        solarAlignment: 'very-poor',
                        description: 'Rotating shifts require maximum battery flexibility'
                    },
                    'remote': {
                        batteryMultiplier: 1.0,
                        usageVariability: 'low',
                        solarAlignment: 'excellent',
                        description: 'Home during solar hours, excellent direct usage potential'
                    },
                    'self-employed': {
                        batteryMultiplier: 1.5,
                        usageVariability: 'medium',
                        solarAlignment: 'good',
                        description: 'Flexible schedule allows good solar usage with some battery backup'
                    },
                    'retired': {
                        batteryMultiplier: 0.8,
                        usageVariability: 'low',
                        solarAlignment: 'excellent',
                        description: 'Perfect solar alignment, minimal battery needed'
                    },
                    'student': {
                        batteryMultiplier: 1.2,
                        usageVariability: 'medium',
                        solarAlignment: 'good',
                        description: 'Variable schedule, moderate battery for flexibility'
                    },
                    'stay-home-parent': {
                        batteryMultiplier: 1.0,
                        usageVariability: 'medium',
                        solarAlignment: 'excellent',
                        description: 'Home during day, excellent solar usage with family flexibility needs'
                    }
                };
            }
            
            /**
             * Main calculation method
             */
            calculateSolarRecommendation(data) {
                // Calculate base system size
                const baseSize = this.calculateBaseSystemSize(data);
                
                // Apply lifestyle modifiers
                const adjustedSize = this.applyLifestyleModifiers(baseSize, data);
                
                // Calculate battery requirements
                const batterySize = this.calculateBatterySize(adjustedSize, data);
                
                // Create system object
                let system = {
                    systemSize: adjustedSize,
                    batterySize: batterySize
                };
                
                // Apply budget constraints
                system = this.applyBudgetConstraints(system, data);
                
                // Calculate financials with both inflation rates
                const financials = this.calculateFinancials(system, data);
                
                // Generate insights
                const insights = this.generateInsights(system, data, financials);
                
                // Calculate confidence score
                const confidence = this.calculateConfidence(data);
                
                return {
                    system,
                    financials,
                    insights,
                    confidence
                };
            }
            
            calculateBaseSystemSize(data) {
                // Base size calculation based on property and usage
                const propertyMultipliers = {
                    'detached': 1.4, 'semi-detached': 1.2, 'terraced': 1.0, 'bungalow': 1.1
                };
                
                const bedroomMultipliers = {
                    '1-2': 0.7, '3': 1.0, '4': 1.3, '5+': 1.6
                };
                
                const billMultipliers = {
                    '40-70': 0.7, '70-100': 1.0, '100-140': 1.3, '140-200': 1.6, '200+': 2.0, 'not-sure': 1.0
                };
                
                let baseSize = 4.0; // Base 4kW system
                baseSize *= propertyMultipliers[data.propertyType] || 1.0;
                baseSize *= bedroomMultipliers[data.bedrooms] || 1.0;
                baseSize *= billMultipliers[data.monthlyBill] || 1.0;
                
                const householdMultipliers = {
                    'just-me': 0.7, 'couple-no-children': 0.9, 'family-young-children': 1.2, 'family-teenagers': 1.4
                };
                baseSize *= householdMultipliers[data.household] || 1.0;
                
                return Math.round(baseSize * 2) / 2;
            }
            
            applyLifestyleModifiers(baseSize, data) {
                let adjustedSize = baseSize;
                
                const evMultipliers = {
                    'have-one': 1.5, 'planning-2-years': 1.3, 'considering-2-5-years': 1.1, 'no-plans': 1.0
                };
                adjustedSize *= evMultipliers[data.evPlans] || 1.0;
                
                if (data.heatingSystem === 'heat-pump') {
                    adjustedSize *= 1.8;
                } else if (data.heatPumpPlans === 'within-2-years') {
                    adjustedSize *= 1.6;
                } else if (data.heatPumpPlans === 'within-5-years') {
                    adjustedSize *= 1.3;
                }
                
                const wfhMultipliers = {
                    'rarely': 0.9, 'sometimes': 1.0, 'often': 1.1, 'always': 1.2, 'varies': 1.05
                };
                adjustedSize *= wfhMultipliers[data.homeDuringDay] || 1.0;
                
                return Math.round(adjustedSize * 2) / 2;
            }
            
            calculateBatterySize(systemSize, data) {
                let batterySize = systemSize * 1.5;
                
                const occupation = this.getOccupationCategory(data.occupation);
                const profile = this.occupationProfiles[occupation];
                if (profile) {
                    batterySize *= profile.batteryMultiplier;
                }
                
                const scheduleMultipliers = {
                    'standard-days': 1.5, 'shift-rotating': 2.5, 'work-from-home': 0.8, 'retired': 0.6
                };
                batterySize *= scheduleMultipliers[data.workSchedule] || 1.5;
                
                const interestMultipliers = {
                    'essential': 1.2, 'very-interested': 1.0, 'somewhat-interested': 0.8, 'not-interested': 0.0
                };
                batterySize *= interestMultipliers[data.batteryInterest] || 1.0;
                
                if (data.batteryInterest === 'not-interested') return 0;
                
                batterySize = Math.max(5, batterySize);
                batterySize = Math.min(25, batterySize);
                
                return Math.round(batterySize * 2) / 2;
            }
            
            applyBudgetConstraints(system, data) {
                const totalCost = (system.systemSize * this.constants.systemCostPerKW) + 
                                 (system.batterySize * this.constants.batteryCostPerKWh);
                
                const budgetLimits = {
                    '5000-8000': 8000, '8000-12000': 12000, '12000-18000': 18000, 
                    '18000-25000': 25000, '25000+': 50000, 'depends-on-payback': 30000
                };
                
                const budgetLimit = budgetLimits[data.budget] || 15000;
                
                if (totalCost <= budgetLimit) return system;
                
                let adjustedSystem = { ...system };
                
                if (data.batteryInterest === 'essential' || data.batteryInterest === 'very-interested') {
                    const minBattery = Math.min(10, system.batterySize);
                    const remainingBudget = budgetLimit - (minBattery * this.constants.batteryCostPerKWh);
                    const maxSystemSize = remainingBudget / this.constants.systemCostPerKW;
                    
                    adjustedSystem.systemSize = Math.max(3, Math.min(system.systemSize, maxSystemSize));
                    adjustedSystem.batterySize = minBattery;
                } else {
                    const maxSystemCost = budgetLimit * 0.8;
                    const maxBatteryCost = budgetLimit * 0.2;
                    
                    adjustedSystem.systemSize = Math.min(system.systemSize, maxSystemCost / this.constants.systemCostPerKW);
                    adjustedSystem.batterySize = Math.min(system.batterySize, maxBatteryCost / this.constants.batteryCostPerKWh);
                }
                
                adjustedSystem.systemSize = Math.round(adjustedSystem.systemSize * 2) / 2;
                adjustedSystem.batterySize = Math.round(adjustedSystem.batterySize * 2) / 2;
                
                return adjustedSystem;
            }
            
            /**
             * FIXED: Calculate financial projections with proper inflation handling
             */
            calculateFinancials(system, data) {
                // Annual solar generation
                const roofMultiplier = this.constants.roofMultipliers[data.roofOrientation] || 0.85;
                const annualGeneration = system.systemSize * this.constants.solarGenerationPerKW * roofMultiplier;
                
                // Self-consumption calculation based on lifestyle
                const selfConsumptionRate = this.calculateSelfConsumptionRate(data, system.batterySize);
                const selfConsumption = Math.min(annualGeneration * selfConsumptionRate, this.estimateAnnualUsage(data));
                
                // Export calculation
                const export_ = Math.max(0, annualGeneration - selfConsumption);
                
                // Annual savings (Year 1)
                const savingsFromSelfUse = selfConsumption * this.constants.electricityPrice;
                const incomeFromExport = export_ * this.constants.exportPrice;
                const annualSavingsYear1 = savingsFromSelfUse + incomeFromExport;
                
                // System cost
                const systemCost = (system.systemSize * this.constants.systemCostPerKW) + 
                                  (system.batterySize * this.constants.batteryCostPerKWh);
                
                // FIXED: Inflation-adjusted payback calculation
                const paybackYears = this.calculateInflationAdjustedPayback(
                    systemCost, 
                    annualSavingsYear1, 
                    this.constants.inflationRateStandard
                );
                
                const paybackYearsCurrentInflation = this.calculateInflationAdjustedPayback(
                    systemCost, 
                    annualSavingsYear1, 
                    this.constants.inflationRateCurrent
                );
                
                // 25-year projections with inflation
                const totalSavings25Years = this.calculateTotalSavingsWithInflation(
                    annualSavingsYear1, 
                    this.constants.inflationRateStandard, 
                    25
                );
                const netSavings25Years = totalSavings25Years - systemCost;
                const roi = (netSavings25Years / systemCost) * 100;
                
                return {
                    systemCost: Math.round(systemCost),
                    annualGeneration: Math.round(annualGeneration),
                    annualSavings: Math.round(annualSavingsYear1),
                    paybackYears: Math.round(paybackYears * 10) / 10,
                    paybackYearsCurrentInflation: Math.round(paybackYearsCurrentInflation * 10) / 10,
                    totalSavings25Years: Math.round(totalSavings25Years),
                    netSavings25Years: Math.round(netSavings25Years),
                    roi: Math.round(roi),
                    selfConsumption: Math.round(selfConsumption),
                    export: Math.round(export_),
                    selfConsumptionRate: Math.round(selfConsumptionRate * 100)
                };
            }
            
            /**
             * NEW: Calculate inflation-adjusted payback period
             */
            calculateInflationAdjustedPayback(systemCost, annualSavingsYear1, inflationRate) {
                let cumulativeSavings = 0;
                let year = 0;
                
                while (cumulativeSavings < systemCost && year < 30) {
                    year++;
                    const savingsThisYear = annualSavingsYear1 * Math.pow(1 + inflationRate, year - 1);
                    cumulativeSavings += savingsThisYear;
                }
                
                // More precise calculation for the final year
                if (year > 1) {
                    const previousYearSavings = cumulativeSavings - (annualSavingsYear1 * Math.pow(1 + inflationRate, year - 1));
                    const remainingCost = systemCost - previousYearSavings;
                    const finalYearSavings = annualSavingsYear1 * Math.pow(1 + inflationRate, year - 1);
                    const fractionOfFinalYear = remainingCost / finalYearSavings;
                    
                    return (year - 1) + fractionOfFinalYear;
                }
                
                return year;
            }
            
            /**
             * NEW: Calculate total savings over period with inflation
             */
            calculateTotalSavingsWithInflation(annualSavingsYear1, inflationRate, years) {
                let totalSavings = 0;
                
                for (let year = 1; year <= years; year++) {
                    const savingsThisYear = annualSavingsYear1 * Math.pow(1 + inflationRate, year - 1);
                    totalSavings += savingsThisYear;
                }
                
                return totalSavings;
            }
            
            calculateSelfConsumptionRate(data, batterySize) {
                let baseRate = batterySize > 0 ? 0.7 : 0.3;
                
                const occupation = this.getOccupationCategory(data.occupation);
                const occupationRates = {
                    'healthcare': 0.4, 'teacher': 0.6, 'office': 0.3, 'shift': 0.35, 
                    'remote': 0.8, 'retired': 0.85
                };
                
                const occupationRate = occupationRates[occupation] || 0.5;
                
                if (batterySize > 0) {
                    return Math.min(0.9, (baseRate + occupationRate) / 2);
                } else {
                    return occupationRate;
                }
            }
            
            estimateAnnualUsage(data) {
                const billToUsage = {
                    '40-70': 2800, '70-100': 3500, '100-140': 4500, '140-200': 6000, '200+': 8000
                };
                
                let annualUsage = billToUsage[data.monthlyBill] || 4000;
                
                if (data.evPlans === 'have-one') annualUsage += 3000;
                if (data.evPlans === 'planning-2-years') annualUsage += 2500;
                if (data.heatingSystem === 'heat-pump') annualUsage += 4000;
                if (data.heatPumpPlans === 'within-2-years') annualUsage += 3500;
                
                return annualUsage;
            }
            
            generateInsights(system, data, financials) {
                const occupation = this.getOccupationCategory(data.occupation);
                const profile = this.occupationProfiles[occupation];
                
                return {
                    lifestyleMatch: this.generateLifestyleInsight(data, profile, occupation),
                    batteryRecommendation: this.generateBatteryInsight(system, data),
                    financialHighlight: this.generateFinancialInsight(financials),
                    optimizationTips: this.generateOptimizationTips(data, system),
                    nextSteps: this.generateNextSteps(system)
                };
            }
            
            generateLifestyleInsight(data, profile, occupation) {
                const insights = {
                    'healthcare': `As a healthcare worker with irregular shifts, your energy usage doesn't align well with solar generation. ${profile.description}. This system is designed to store solar energy during your shifts for use when you're home.`,
                    'teacher': `Your teaching schedule aligns well with solar generation during term time. ${profile.description}. You'll see excellent direct usage during school holidays when you're home more.`,
                    'office': `Working standard office hours means you're away during peak solar generation. ${profile.description}. Your battery will charge during the day and power your home in the evenings.`,
                    'shift': `Rotating shift work creates unpredictable energy patterns. ${profile.description}. The large battery ensures you have stored solar energy regardless of your current shift pattern.`,
                    'remote': `Working from home gives you excellent solar alignment. ${profile.description}. You'll use most of your solar energy directly, minimizing battery needs and maximizing savings.`,
                    'retired': `Your retirement lifestyle perfectly matches solar generation patterns. ${profile.description}. You'll achieve excellent direct usage with minimal reliance on the grid.`
                };
                
                return insights[occupation] || `Your lifestyle has been analyzed to optimize your solar system design. The recommended system balances your energy needs with your daily patterns.`;
            }
            
            generateOptimizationTips(data, system) {
                const tips = [
                    'Set washing machine and dishwasher to run during sunny days when possible',
                    'Charge devices and run high-energy appliances during peak solar hours (10am-3pm)'
                ];
                
                if (system.batterySize > 0) {
                    tips.push('Consider smart home automation to maximize battery efficiency');
                }
                
                if (data.evPlans === 'have-one' || data.evPlans === 'planning-2-years') {
                    tips.push('Schedule EV charging during peak solar generation hours');
                }
                
                return tips;
            }
            
            generateNextSteps(system) {
                return [
                    `Get quotes for a ${system.systemSize}kW system with ${system.batterySize}kWh battery`,
                    'Use our quote analyzer to verify pricing and quality',
                    'Ensure installers are MCS certified and properly insured',
                    'Compare at least 3 quotes before making a decision'
                ];
            }
            
            calculateConfidence(data) {
                let confidence = 85; // Base confidence
                
                // Increase confidence for complete data
                if (data.monthlyBill && data.monthlyBill !== 'not-sure') confidence += 5;
                if (data.roofOrientation) confidence += 5;
                if (data.occupation) confidence += 3;
                if (data.workSchedule) confidence += 2;
                
                return Math.min(95, confidence);
            }
            
            getOccupationCategory(occupation) {
                const categoryMap = {
                    'healthcare-worker': 'healthcare',
                    'teacher-educator': 'teacher',
                    'office-worker': 'office',
                    'shift-worker': 'shift',
                    'work-from-home': 'remote',
                    'self-employed': 'self-employed',
                    'retired': 'retired',
                    'student': 'student',
                    'stay-home-parent': 'stay-home-parent'
                };
                
                return categoryMap[occupation] || 'office';
            }
        }
    </script>
</body>
</html>

