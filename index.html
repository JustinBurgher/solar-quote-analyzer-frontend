<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Truth AI - Independent Solar Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #2563eb;
        }

        .logo::before {
            content: "‚òÄÔ∏è";
            margin-right: 0.5rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            text-decoration: none;
            color: #666;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover {
            color: #2563eb;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: white;
            color: #2563eb;
        }

        .btn-primary:hover {
            background: #f8fafc;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: white;
            color: #2563eb;
        }

        /* Problem Section */
        .problem {
            padding: 4rem 0;
            background: #f8fafc;
        }

        .problem h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #1e293b;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .problem-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .problem-card .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .problem-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        /* Solution Section */
        .solution {
            padding: 4rem 0;
        }

        .solution h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #1e293b;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .feature {
            text-align: center;
            padding: 1.5rem;
        }

        .feature .icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .feature h3 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .sample-results {
            background: #f8fafc;
            padding: 2rem;
            border-radius: 12px;
            margin-top: 3rem;
        }

        .sample-results h3 {
            text-align: center;
            margin-bottom: 2rem;
            color: #1e293b;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .result-item {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .result-score {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .score-good { color: #059669; }
        .score-okay { color: #d97706; }
        .score-poor { color: #dc2626; }

        /* Consultation Section */
        .consultation {
            padding: 4rem 0;
            background: #f8fafc;
        }

        .consultation h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .consultation-subtitle {
            text-align: center;
            font-size: 1.25rem;
            color: #64748b;
            margin-bottom: 3rem;
        }

        .consultation-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .question-container {
            margin-bottom: 2rem;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .question-number {
            background: #2563eb;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .question-title {
            font-size: 1.5rem;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .option-card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-card:hover {
            border-color: #2563eb;
            background: #eff6ff;
        }

        .option-card.selected {
            border-color: #2563eb;
            background: #eff6ff;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .option-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .option-text {
            font-weight: 600;
            color: #1e293b;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .btn-nav {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-previous {
            background: #6b7280;
            color: white;
        }

        .btn-previous:hover {
            background: #4b5563;
        }

        .btn-next {
            background: #2563eb;
            color: white;
        }

        .btn-next:hover {
            background: #1d4ed8;
        }

        .btn-nav:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Results Section */
        .results {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .results h3 {
            font-size: 2rem;
            color: #1e293b;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .recommendation-card {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .system-size {
            font-size: 1.5rem;
            font-weight: bold;
            color: #0369a1;
            margin-bottom: 1rem;
        }

        .financial-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .financial-item {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .financial-value {
            font-size: 1.25rem;
            font-weight: bold;
            color: #059669;
        }

        .financial-label {
            color: #64748b;
            font-size: 0.9rem;
        }

        .inflation-toggle {
            margin: 1rem 0;
            text-align: center;
        }

        .toggle-button {
            background: #e2e8f0;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            margin: 0 0.5rem;
            transition: all 0.3s;
        }

        .toggle-button.active {
            background: #2563eb;
            color: white;
        }

        .insights {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .insights h4 {
            color: #92400e;
            margin-bottom: 0.5rem;
        }

        .cta-section {
            text-align: center;
            margin-top: 2rem;
            padding: 2rem;
            background: #f8fafc;
            border-radius: 12px;
        }

        /* Analyzer Section */
        .analyzer {
            padding: 4rem 0;
        }

        .analyzer h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #1e293b;
        }

        .analyzer-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .tabs {
            display: flex;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .tab-button {
            flex: 1;
            padding: 1rem;
            border: none;
            background: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-button.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }

        .size-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .size-btn {
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .size-btn:hover {
            border-color: #2563eb;
            background: #eff6ff;
        }

        .size-btn.selected {
            border-color: #2563eb;
            background: #2563eb;
            color: white;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #2563eb;
        }

        .battery-section {
            margin-top: 1rem;
        }

        .battery-controls {
            display: flex;
            gap: 1rem;
            align-items: end;
            flex-wrap: wrap;
        }

        .battery-dropdown {
            flex: 2;
            min-width: 200px;
        }

        .battery-quantity {
            flex: 1;
            min-width: 100px;
        }

        .custom-battery {
            margin-top: 1rem;
        }

        .hidden {
            display: none !important;
        }

        .analyze-btn {
            width: 100%;
            padding: 1rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .analyze-btn:hover {
            background: #1d4ed8;
        }

        /* Analysis Results */
        .analysis-results {
            margin-top: 2rem;
            padding: 2rem;
            background: #f8fafc;
            border-radius: 12px;
        }

        .analysis-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .analysis-header h3 {
            font-size: 2rem;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .overall-score {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .score-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .score-emoji {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .score-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .score-label {
            color: #64748b;
            font-size: 0.9rem;
        }

        .analysis-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .analysis-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .analysis-section h4 {
            color: #1e293b;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }

        .analysis-section ul {
            list-style: none;
        }

        .analysis-section li {
            margin-bottom: 0.5rem;
            color: #4b5563;
        }

        /* Get Advice Section */
        .get-advice {
            padding: 4rem 0;
            background: #f8fafc;
            text-align: center;
        }

        .get-advice h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .get-advice p {
            font-size: 1.25rem;
            color: #64748b;
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .advice-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .advice-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .advice-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .advice-card p {
            color: #64748b;
            margin-bottom: 2rem;
        }

        .advice-card .btn {
            width: 100%;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }

            .problem-grid,
            .features-grid {
                grid-template-columns: 1fr;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }

            .size-buttons {
                grid-template-columns: repeat(3, 1fr);
            }

            .battery-controls {
                flex-direction: column;
            }

            .battery-dropdown,
            .battery-quantity {
                flex: none;
                width: 100%;
            }

            .overall-score {
                flex-direction: column;
                align-items: center;
            }

            .analysis-sections {
                grid-template-columns: 1fr;
            }

            .advice-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">Solar Truth AI</div>
                <nav>
                    <ul>
                        <li><a href="#problem">The Problem</a></li>
                        <li><a href="#solution">Our Solution</a></li>
                        <li><a href="#analyzer">Free Analysis</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Don't Get Ripped Off on Solar</h1>
            <p>Get independent analysis of your solar quotes. No installer bias, just honest advice.</p>
            <div class="cta-buttons">
                <button class="btn btn-primary" onclick="scrollToConsultation()">Find Out What You Need FREE</button>
                <button class="btn btn-secondary" onclick="scrollToAnalyzer()">Analyze My Quote FREE</button>
            </div>
        </div>
    </section>

    <!-- Problem Section -->
    <section id="problem" class="problem">
        <div class="container">
            <h2>The Solar Industry Has a Problem</h2>
            <div class="problem-grid">
                <div class="problem-card">
                    <div class="icon">üí∏</div>
                    <h3>Overpriced Quotes</h3>
                    <p>Many homeowners pay 20-40% more than they should for solar installations due to lack of independent advice.</p>
                </div>
                <div class="problem-card">
                    <div class="icon">üìâ</div>
                    <h3>Poor Quality Equipment</h3>
                    <p>Installers often push cheaper panels and batteries to maximize their profits, not your savings.</p>
                </div>
                <div class="problem-card">
                    <div class="icon">ü§∑</div>
                    <h3>Biased Advice</h3>
                    <p>Every installer has a vested interest in selling you their preferred system, not what's best for you.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Solution Section -->
    <section id="solution" class="solution">
        <div class="container">
            <h2>Introducing Solar Truth AI</h2>
            <div class="features-grid">
                <div class="feature">
                    <div class="icon">üîç</div>
                    <h3>Independent Analysis</h3>
                    <p>We're not installers. We don't sell solar. We just tell you the truth about your quotes.</p>
                </div>
                <div class="feature">
                    <div class="icon">üí∞</div>
                    <h3>Price Comparison</h3>
                    <p>See if you're paying a fair price compared to current UK market rates.</p>
                </div>
                <div class="feature">
                    <div class="icon">‚≠ê</div>
                    <h3>Quality Assessment</h3>
                    <p>Get honest ratings on panel and battery quality from industry experts.</p>
                </div>
                <div class="feature">
                    <div class="icon">üìä</div>
                    <h3>Value Score</h3>
                    <p>Our algorithm calculates an overall value score to help you make the right decision.</p>
                </div>
            </div>

            <div class="sample-results">
                <h3>Sample Analysis Results</h3>
                <div class="results-grid">
                    <div class="result-item">
                        <div class="result-score score-good">8.5/10</div>
                        <div>Overall Value</div>
                    </div>
                    <div class="result-item">
                        <div class="result-score score-okay">¬£14,750</div>
                        <div>Fair Price Range</div>
                    </div>
                    <div class="result-item">
                        <div class="result-score score-good">Good</div>
                        <div>Panel Quality</div>
                    </div>
                    <div class="result-item">
                        <div class="result-score score-poor">Poor</div>
                        <div>Battery Choice</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Consultation Section -->
    <section id="consultation" class="consultation">
        <div class="container">
            <h2>What Solar System Do You Need?</h2>
            <p class="consultation-subtitle">Answer 14 quick questions to get your personalized recommendation</p>
            
            <div class="consultation-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                
                <div class="question-container" id="question-container">
                    <!-- Questions will be dynamically inserted here -->
                </div>

                <div class="navigation-buttons">
                    <button class="btn-nav btn-previous" id="prev-btn" onclick="previousQuestion()" disabled>Previous</button>
                    <button class="btn-nav btn-next" id="next-btn" onclick="nextQuestion()" disabled>Next</button>
                </div>
            </div>

            <div class="results hidden" id="consultation-results">
                <!-- Results will be shown here -->
            </div>
        </div>
    </section>

    <!-- Analyzer Section -->
    <section id="analyzer" class="analyzer">
        <div class="container">
            <h2>Analyze Your Solar Quote Now</h2>
            
            <div class="analyzer-container">
                <div class="tabs">
                    <button class="tab-button active" onclick="switchTab('manual')">Manual Entry</button>
                    <button class="tab-button" onclick="switchTab('pdf')">PDF Upload</button>
                </div>

                <div id="manual-tab" class="tab-content active">
                    <form id="quote-form">
                        <div class="form-group">
                            <label class="form-label">System Size</label>
                            <div class="size-buttons" id="system-size-buttons">
                                <button type="button" class="size-btn" data-size="2">2kW</button>
                                <button type="button" class="size-btn" data-size="3">3kW</button>
                                <button type="button" class="size-btn" data-size="4">4kW</button>
                                <button type="button" class="size-btn" data-size="5">5kW</button>
                                <button type="button" class="size-btn" data-size="6">6kW</button>
                                <button type="button" class="size-btn" data-size="7">7kW</button>
                                <button type="button" class="size-btn" data-size="8">8kW</button>
                                <button type="button" class="size-btn" data-size="9">9kW</button>
                                <button type="button" class="size-btn" data-size="10">10kW</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Panel Output</label>
                            <div class="size-buttons" id="panel-output-buttons">
                                <button type="button" class="size-btn" data-output="300">300W</button>
                                <button type="button" class="size-btn" data-output="350">350W</button>
                                <button type="button" class="size-btn" data-output="400">400W</button>
                                <button type="button" class="size-btn" data-output="450">450W</button>
                                <button type="button" class="size-btn" data-output="500">500W</button>
                                <button type="button" class="size-btn" data-output="550">550W</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="panel-brand">Panel Brand</label>
                            <select class="form-select" id="panel-brand" required>
                                <option value="">Select panel brand...</option>
                                <option value="DMEGC">DMEGC</option>
                                <option value="Perlight">Perlight</option>
                                <option value="LONGi">LONGi</option>
                                <option value="Jinko Solar">Jinko Solar</option>
                                <option value="Trina Solar">Trina Solar</option>
                                <option value="Canadian Solar">Canadian Solar</option>
                                <option value="JA Solar">JA Solar</option>
                                <option value="Risen Energy">Risen Energy</option>
                                <option value="Aiko Solar">Aiko Solar</option>
                                <option value="SunPower">SunPower</option>
                                <option value="REC">REC</option>
                                <option value="Panasonic">Panasonic</option>
                                <option value="LG">LG</option>
                                <option value="Q CELLS">Q CELLS</option>
                                <option value="Hyundai">Hyundai</option>
                                <option value="Eurener">Eurener</option>
                                <option value="SolFiT BIPV">SolFiT BIPV</option>
                                <option value="InstaGen">InstaGen</option>
                                <option value="Other">Other (specify)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Include Battery Storage?</label>
                            <div class="size-buttons">
                                <button type="button" class="size-btn" data-battery="yes">Yes</button>
                                <button type="button" class="size-btn" data-battery="no">No</button>
                            </div>
                        </div>

                        <div class="battery-section hidden" id="battery-section">
                            <div class="form-group">
                                <label class="form-label">Battery Details</label>
                                <div class="battery-controls">
                                    <div class="battery-dropdown">
                                        <select class="form-select" id="battery-brand">
                                            <option value="">Select battery...</option>
                                            <option value="GivEnergy 5.12kWh GEN3">GivEnergy 5.12kWh GEN3</option>
                                            <option value="GivEnergy 9.5kWh GEN3">GivEnergy 9.5kWh GEN3</option>
                                            <option value="GivEnergy 13.5kWh (3x 4.5kWh)">GivEnergy 13.5kWh (3x 4.5kWh)</option>
                                            <option value="Fox ESS ECS2900 (2.6kWh)">Fox ESS ECS2900 (2.6kWh)</option>
                                            <option value="Fox ESS ECS4100 (3.7kWh)">Fox ESS ECS4100 (3.7kWh)</option>
                                            <option value="Fox ESS ECS5200 (5.2kWh)">Fox ESS ECS5200 (5.2kWh)</option>
                                            <option value="Fox ESS ECS7800 (7.8kWh)">Fox ESS ECS7800 (7.8kWh)</option>
                                            <option value="Fox ESS ECS10400 (10.4kWh)">Fox ESS ECS10400 (10.4kWh)</option>
                                            <option value="SolarEdge Energy Bank 10kWh">SolarEdge Energy Bank 10kWh</option>
                                            <option value="SolarEdge Energy Bank 20kWh">SolarEdge Energy Bank 20kWh</option>
                                            <option value="SolarEdge Energy Bank 30kWh">SolarEdge Energy Bank 30kWh</option>
                                            <option value="Tesla Powerwall 2 (13.5kWh)">Tesla Powerwall 2 (13.5kWh)</option>
                                            <option value="Tesla Powerwall 3 (13.5kWh)">Tesla Powerwall 3 (13.5kWh)</option>
                                            <option value="SolaX Triple Power T58 (5.8kWh)">SolaX Triple Power T58 (5.8kWh)</option>
                                            <option value="SolaX Triple Power T63 (6.3kWh)">SolaX Triple Power T63 (6.3kWh)</option>
                                            <option value="Growatt ARK-2.5H-A1 (2.5kWh)">Growatt ARK-2.5H-A1 (2.5kWh)</option>
                                            <option value="Growatt ARK XH (5.12kWh)">Growatt ARK XH (5.12kWh)</option>
                                            <option value="Huawei LUNA2000 (5kWh)">Huawei LUNA2000 (5kWh)</option>
                                            <option value="Huawei LUNA2000 (10kWh)">Huawei LUNA2000 (10kWh)</option>
                                            <option value="Huawei LUNA2000 (15kWh)">Huawei LUNA2000 (15kWh)</option>
                                            <option value="Enphase IQ Battery 5P (5kWh)">Enphase IQ Battery 5P (5kWh)</option>
                                            <option value="Enphase IQ Battery 10 (10kWh)">Enphase IQ Battery 10 (10kWh)</option>
                                            <option value="Sungrow SBR HV (9.6kWh)">Sungrow SBR HV (9.6kWh)</option>
                                            <option value="Sungrow SBR HV (12.8kWh)">Sungrow SBR HV (12.8kWh)</option>
                                            <option value="Pylontech US3000C (3.55kWh)">Pylontech US3000C (3.55kWh)</option>
                                            <option value="Pylontech US5000 (4.8kWh)">Pylontech US5000 (4.8kWh)</option>
                                            <option value="BYD Battery-Box Premium LVS (4kWh)">BYD Battery-Box Premium LVS (4kWh)</option>
                                            <option value="BYD Battery-Box Premium HVS (5.1kWh)">BYD Battery-Box Premium HVS (5.1kWh)</option>
                                            <option value="LG Chem RESU10H (9.8kWh)">LG Chem RESU10H (9.8kWh)</option>
                                            <option value="LG Chem RESU16H (16kWh)">LG Chem RESU16H (16kWh)</option>
                                            <option value="Myenergi Libbi (5kWh)">Myenergi Libbi (5kWh)</option>
                                            <option value="Myenergi Libbi (10kWh)">Myenergi Libbi (10kWh)</option>
                                            <option value="Myenergi Libbi (15kWh)">Myenergi Libbi (15kWh)</option>
                                            <option value="Myenergi Libbi (20kWh)">Myenergi Libbi (20kWh)</option>
                                            <option value="Other">Other (specify)</option>
                                        </select>
                                    </div>
                                    <div class="battery-quantity">
                                        <select class="form-select" id="battery-quantity">
                                            <option value="1">1 Battery</option>
                                            <option value="2">2 Batteries</option>
                                            <option value="3">3 Batteries</option>
                                            <option value="4">4+ Batteries</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="custom-battery hidden" id="custom-battery">
                                    <input type="text" class="form-input" id="custom-battery-input" placeholder="Enter battery model and capacity (e.g., Custom LiFePO4 8kWh)">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="quote-price">Total Quote Price (¬£)</label>
                            <input type="number" class="form-input" id="quote-price" placeholder="e.g., 15000" required>
                        </div>

                        <button type="submit" class="analyze-btn">Analyze Quote</button>
                    </form>
                </div>

                <div id="pdf-tab" class="tab-content">
                    <div style="text-align: center; padding: 3rem; color: #64748b;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üìÑ</div>
                        <h3>PDF Upload Coming Soon</h3>
                        <p>We're working on automatic PDF quote analysis. For now, please use manual entry above.</p>
                    </div>
                </div>

                <div class="analysis-results hidden" id="analysis-results">
                    <div class="analysis-header">
                        <h3>Your Quote Analysis</h3>
                        <p>Independent assessment of your solar quote</p>
                    </div>

                    <div class="overall-score">
                        <div class="score-card">
                            <div class="score-emoji" id="price-emoji">üí∞</div>
                            <div class="score-value" id="price-score">-</div>
                            <div class="score-label">Price Assessment</div>
                        </div>
                        <div class="score-card">
                            <div class="score-emoji" id="quality-emoji">‚≠ê</div>
                            <div class="score-value" id="quality-score">-</div>
                            <div class="score-label">Quality Rating</div>
                        </div>
                        <div class="score-card">
                            <div class="score-emoji" id="value-emoji">üéØ</div>
                            <div class="score-value" id="value-score">-</div>
                            <div class="score-label">Overall Value</div>
                        </div>
                    </div>

                    <div class="analysis-sections">
                        <div class="analysis-section">
                            <h4>Key Insights</h4>
                            <ul id="key-insights">
                                <!-- Insights will be populated here -->
                            </ul>
                        </div>
                        <div class="analysis-section">
                            <h4>Things to Consider</h4>
                            <ul id="considerations">
                                <!-- Considerations will be populated here -->
                            </ul>
                        </div>
                        <div class="analysis-section">
                            <h4>Our Recommendations</h4>
                            <ul id="recommendations">
                                <!-- Recommendations will be populated here -->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Get Advice Section -->
    <section class="get-advice">
        <div class="container">
            <h2>Get Independent Solar Advice</h2>
            <p>Have questions? Need help analyzing a complex quote? Our solar experts are here to help.</p>
            
            <div class="advice-options">
                <div class="advice-card">
                    <h3>Free Analysis</h3>
                    <p>Get instant analysis of your solar quotes with our free tools.</p>
                    <button class="btn btn-primary" onclick="scrollToAnalyzer()">Start Analysis</button>
                </div>
                <div class="advice-card">
                    <h3>Expert Consultation</h3>
                    <p>Book a call with our solar experts for personalized advice.</p>
                    <button class="btn btn-secondary">Book Consultation</button>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Consultation Questions Data
        const consultationQuestions = [
            {
                id: 1,
                title: "What type of property do you live in?",
                options: [
                    { value: "detached", text: "Detached House", icon: "üè†" },
                    { value: "semi-detached", text: "Semi-Detached House", icon: "üèòÔ∏è" },
                    { value: "terraced", text: "Terraced House", icon: "üèöÔ∏è" },
                    { value: "bungalow", text: "Bungalow", icon: "üè°" }
                ]
            },
            {
                id: 2,
                title: "How many bedrooms does your home have?",
                options: [
                    { value: "1-2", text: "1-2 Bedrooms", icon: "üõèÔ∏è" },
                    { value: "3", text: "3 Bedrooms", icon: "üõèÔ∏è" },
                    { value: "4", text: "4 Bedrooms", icon: "üõèÔ∏è" },
                    { value: "5+", text: "5+ Bedrooms", icon: "üõèÔ∏è" }
                ]
            },
            {
                id: 3,
                title: "What best describes your work situation?",
                options: [
                    { value: "healthcare", text: "Healthcare Worker", icon: "üë©‚Äç‚öïÔ∏è" },
                    { value: "teacher", text: "Teacher/Education", icon: "üë®‚Äçüè´" },
                    { value: "office", text: "Office Worker", icon: "üíº" },
                    { value: "remote", text: "Work from Home", icon: "üè†" },
                    { value: "shift", text: "Shift Worker", icon: "üåô" },
                    { value: "retired", text: "Retired", icon: "üë¥" },
                    { value: "other", text: "Other", icon: "üë§" }
                ]
            },
            {
                id: 4,
                title: "What's your typical work schedule?",
                options: [
                    { value: "standard", text: "Standard Days (9am-5pm)", icon: "üåÖ" },
                    { value: "shift-rotating", text: "Shift Work - Rotating", icon: "üåô" },
                    { value: "shift-nights", text: "Mostly Night Shifts", icon: "üåÉ" },
                    { value: "flexible", text: "Flexible Hours", icon: "‚è∞" },
                    { value: "home", text: "Work from Home", icon: "üè†" },
                    { value: "retired", text: "Retired/Not Working", icon: "üèñÔ∏è" }
                ]
            },
            {
                id: 5,
                title: "How often are you home during the day (9am-4pm)?",
                options: [
                    { value: "always", text: "Always Home", icon: "üè†" },
                    { value: "mostly", text: "Mostly Home", icon: "üè°" },
                    { value: "sometimes", text: "Sometimes Home", icon: "üö™" },
                    { value: "rarely", text: "Rarely Home", icon: "üöó" }
                ]
            },
            {
                id: 6,
                title: "How many people live in your household?",
                options: [
                    { value: "1", text: "1 Person", icon: "üë§" },
                    { value: "2", text: "2 People", icon: "üë•" },
                    { value: "3-4", text: "3-4 People", icon: "üë®‚Äçüë©‚Äçüëß" },
                    { value: "5+", text: "5+ People", icon: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶" }
                ]
            },
            {
                id: 7,
                title: "What's your current monthly electricity bill?",
                options: [
                    { value: "under-50", text: "Under ¬£50", icon: "üí∑" },
                    { value: "50-100", text: "¬£50-¬£100", icon: "üí∑" },
                    { value: "100-150", text: "¬£100-¬£150", icon: "üí∑" },
                    { value: "150-200", text: "¬£150-¬£200", icon: "üí∑" },
                    { value: "over-200", text: "Over ¬£200", icon: "üí∑" }
                ]
            },
            {
                id: 8,
                title: "Do you plan to get an electric vehicle?",
                options: [
                    { value: "have-one", text: "Already Have One", icon: "üöó" },
                    { value: "within-year", text: "Within 1 Year", icon: "üöô" },
                    { value: "1-3-years", text: "In 1-3 Years", icon: "üöï" },
                    { value: "maybe-future", text: "Maybe in Future", icon: "ü§î" },
                    { value: "no-plans", text: "No Plans", icon: "‚õΩ" }
                ]
            },
            {
                id: 9,
                title: "What type of heating system do you have?",
                options: [
                    { value: "gas-boiler", text: "Gas Boiler", icon: "üî•" },
                    { value: "heat-pump", text: "Heat Pump", icon: "‚ô®Ô∏è" },
                    { value: "electric", text: "Electric Heating", icon: "‚ö°" },
                    { value: "oil", text: "Oil Heating", icon: "üõ¢Ô∏è" },
                    { value: "other", text: "Other", icon: "üè†" }
                ]
            },
            {
                id: 10,
                title: "Are you planning to install a heat pump?",
                options: [
                    { value: "have-one", text: "Already Have One", icon: "‚ô®Ô∏è" },
                    { value: "within-year", text: "Within 1 Year", icon: "üìÖ" },
                    { value: "1-3-years", text: "In 1-3 Years", icon: "üìÜ" },
                    { value: "considering", text: "Considering It", icon: "ü§î" },
                    { value: "no-plans", text: "No Plans", icon: "‚ùå" }
                ]
            },
            {
                id: 11,
                title: "Which direction does your roof mainly face?",
                options: [
                    { value: "south", text: "South", icon: "‚òÄÔ∏è" },
                    { value: "south-east", text: "South-East", icon: "üåÖ" },
                    { value: "south-west", text: "South-West", icon: "üåá" },
                    { value: "east-west", text: "East/West", icon: "üåÑ" },
                    { value: "north", text: "North", icon: "üß≠" },
                    { value: "not-sure", text: "Not Sure", icon: "‚ùì" }
                ]
            },
            {
                id: 12,
                title: "What's your main goal with solar?",
                options: [
                    { value: "save-money", text: "Save Money on Bills", icon: "üí∞" },
                    { value: "environmental", text: "Environmental Impact", icon: "üå±" },
                    { value: "energy-independence", text: "Energy Independence", icon: "üîã" },
                    { value: "property-value", text: "Increase Property Value", icon: "üè†" },
                    { value: "all-above", text: "All of the Above", icon: "‚≠ê" }
                ]
            },
            {
                id: 13,
                title: "How interested are you in battery storage?",
                options: [
                    { value: "very-interested", text: "Very Interested", icon: "üîã" },
                    { value: "somewhat", text: "Somewhat Interested", icon: "ü§î" },
                    { value: "not-sure", text: "Not Sure", icon: "‚ùì" },
                    { value: "not-interested", text: "Not Interested", icon: "‚ùå" }
                ]
            },
            {
                id: 14,
                title: "Do you have any other major electrical appliances planned?",
                options: [
                    { value: "hot-tub", text: "Hot Tub/Spa", icon: "üõÅ" },
                    { value: "pool", text: "Swimming Pool", icon: "üèä" },
                    { value: "workshop", text: "Workshop/Garage", icon: "üîß" },
                    { value: "home-office", text: "Home Office Setup", icon: "üíª" },
                    { value: "none", text: "None Planned", icon: "‚úÖ" }
                ]
            }
        ];

        // Consultation State
        let currentQuestion = 0;
        let consultationAnswers = {};

        // Initialize consultation
        function initializeConsultation() {
            showQuestion(0);
            updateProgress();
        }

        function showQuestion(questionIndex) {
            const question = consultationQuestions[questionIndex];
            const container = document.getElementById('question-container');
            
            container.innerHTML = `
                <div class="question-header">
                    <div class="question-number">${question.id} of ${consultationQuestions.length}</div>
                </div>
                <h3 class="question-title">${question.title}</h3>
                <div class="options-grid">
                    ${question.options.map(option => `
                        <div class="option-card" onclick="selectOption('${question.id}', '${option.value}')">
                            <div class="option-icon">${option.icon}</div>
                            <div class="option-text">${option.text}</div>
                        </div>
                    `).join('')}
                </div>
            `;

            // Update navigation buttons
            document.getElementById('prev-btn').disabled = questionIndex === 0;
            document.getElementById('next-btn').disabled = true;
            
            // Restore previous selection if exists
            if (consultationAnswers[question.id]) {
                const selectedCard = container.querySelector(`[onclick*="'${consultationAnswers[question.id]}'"]`);
                if (selectedCard) {
                    selectedCard.classList.add('selected');
                    document.getElementById('next-btn').disabled = false;
                }
            }
        }

        function selectOption(questionId, value) {
            // Remove previous selection
            document.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            event.target.closest('.option-card').classList.add('selected');
            
            // Store answer
            consultationAnswers[questionId] = value;
            
            // Enable next button
            document.getElementById('next-btn').disabled = false;
        }

        function nextQuestion() {
            if (currentQuestion < consultationQuestions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
                updateProgress();
            } else {
                // Show results
                showConsultationResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / consultationQuestions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        function showConsultationResults() {
            // Calculate recommendation based on answers
            const recommendation = calculateRecommendation(consultationAnswers);
            
            const resultsContainer = document.getElementById('consultation-results');
            resultsContainer.innerHTML = `
                <h3>Your Personalized Solar Recommendation</h3>
                <div class="recommendation-card">
                    <div class="system-size">${recommendation.systemSize}kW Solar System${recommendation.batterySize ? ' + ' + recommendation.batterySize + 'kWh Battery' : ''}</div>
                    <div class="financial-summary">
                        <div class="financial-item">
                            <div class="financial-value">¬£${recommendation.estimatedCost.toLocaleString()}</div>
                            <div class="financial-label">Estimated Cost</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-value">¬£${recommendation.annualSavings}</div>
                            <div class="financial-label">Annual Savings</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-value" id="payback-display">${recommendation.paybackYears} years</div>
                            <div class="financial-label">Payback Period</div>
                        </div>
                    </div>
                    <div class="inflation-toggle">
                        <span>Inflation rate: </span>
                        <button class="toggle-button active" onclick="toggleInflation(3.5)">3.5%</button>
                        <button class="toggle-button" onclick="toggleInflation(7)">7%</button>
                    </div>
                    <div class="insights">
                        <h4>Personalized Insights</h4>
                        <p>${recommendation.insights}</p>
                    </div>
                </div>
                <div class="cta-section">
                    <h3>Ready to Analyze Your Quotes?</h3>
                    <p>Now that you know what system you need, let's analyze installer quotes to make sure you get the best deal.</p>
                    <button class="btn btn-primary" onclick="scrollToAnalyzer()">Now Analyze Your Quotes</button>
                </div>
            `;
            
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
            
            // Hide consultation form
            document.querySelector('.consultation-container').style.display = 'none';
        }

        function calculateRecommendation(answers) {
            // Base system size calculation
            let systemSize = 4; // Base 4kW
            let batterySize = 0;
            let estimatedCost = 12000;
            
            // Adjust based on property type
            if (answers['1'] === 'detached') systemSize += 2;
            else if (answers['1'] === 'semi-detached') systemSize += 1;
            
            // Adjust based on bedrooms
            if (answers['2'] === '4') systemSize += 1;
            else if (answers['2'] === '5+') systemSize += 2;
            
            // Adjust based on household size
            if (answers['6'] === '3-4') systemSize += 0.5;
            else if (answers['6'] === '5+') systemSize += 1;
            
            // Adjust based on electricity bill
            if (answers['7'] === '150-200') systemSize += 1;
            else if (answers['7'] === 'over-200') systemSize += 2;
            
            // EV considerations
            if (answers['8'] === 'have-one' || answers['8'] === 'within-year') {
                systemSize += 2;
                batterySize += 5;
            } else if (answers['8'] === '1-3-years') {
                systemSize += 1;
                batterySize += 3;
            }
            
            // Heat pump considerations
            if (answers['10'] === 'have-one' || answers['10'] === 'within-year') {
                systemSize += 2;
                batterySize += 3;
            }
            
            // Work pattern battery sizing
            if (answers['3'] === 'healthcare' || answers['4'] === 'shift-rotating') {
                batterySize += 8; // High battery need for irregular schedules
            } else if (answers['3'] === 'office' || answers['5'] === 'rarely') {
                batterySize += 6; // Medium battery need for away during day
            } else if (answers['3'] === 'retired' || answers['5'] === 'always') {
                batterySize += 2; // Low battery need for home during solar hours
            }
            
            // Battery interest
            if (answers['13'] === 'very-interested') {
                batterySize += 3;
            } else if (answers['13'] === 'not-interested') {
                batterySize = Math.max(0, batterySize - 5);
            }
            
            // Round to reasonable sizes
            systemSize = Math.round(systemSize * 2) / 2; // Round to nearest 0.5kW
            systemSize = Math.min(Math.max(systemSize, 3), 10); // Cap between 3-10kW
            
            if (batterySize > 0) {
                batterySize = Math.round(batterySize);
                batterySize = Math.min(Math.max(batterySize, 5), 20); // Cap between 5-20kWh
            }
            
            // Calculate costs
            estimatedCost = (systemSize * 1800) + (batterySize * 800);
            
            // Calculate savings (rough estimate)
            const annualGeneration = systemSize * 900; // kWh per year
            const annualSavings = Math.round(annualGeneration * 0.30); // 30p per kWh average
            
            // Calculate payback with 3.5% inflation
            const paybackYears = calculateInflationAdjustedPayback(estimatedCost, annualSavings, 3.5);
            
            // Generate insights
            let insights = generatePersonalizedInsights(answers, systemSize, batterySize);
            
            return {
                systemSize,
                batterySize,
                estimatedCost,
                annualSavings,
                paybackYears,
                insights
            };
        }

        function calculateInflationAdjustedPayback(cost, annualSavings, inflationRate) {
            let totalSavings = 0;
            let year = 0;
            
            while (totalSavings < cost && year < 25) {
                year++;
                const yearSavings = annualSavings * Math.pow(1 + inflationRate/100, year - 1);
                totalSavings += yearSavings;
            }
            
            return Math.round(year * 10) / 10; // Round to 1 decimal place
        }

        function toggleInflation(rate) {
            // Update button states
            document.querySelectorAll('.toggle-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Recalculate payback with new rate
            const recommendation = calculateRecommendation(consultationAnswers);
            const newPayback = calculateInflationAdjustedPayback(
                recommendation.estimatedCost, 
                recommendation.annualSavings, 
                rate
            );
            
            document.getElementById('payback-display').textContent = `${newPayback} years`;
        }

        function generatePersonalizedInsights(answers, systemSize, batterySize) {
            let insights = [];
            
            // Work pattern insights
            if (answers['3'] === 'healthcare' || answers['4'] === 'shift-rotating') {
                insights.push("As a healthcare worker with irregular shifts, your energy usage doesn't align well with solar generation. Your shift work means you need large battery storage for energy flexibility.");
            } else if (answers['3'] === 'retired' || answers['5'] === 'always') {
                insights.push("Being home during the day means you can use solar energy as it's generated, reducing your need for battery storage and maximizing your savings.");
            } else if (answers['3'] === 'office' || answers['5'] === 'rarely') {
                insights.push("Working standard hours means you're away during peak solar generation. Battery storage will help you use your solar energy when you're home in the evenings.");
            }
            
            // EV insights
            if (answers['8'] === 'have-one' || answers['8'] === 'within-year') {
                insights.push("Your electric vehicle will significantly increase your electricity usage. We've sized your system to handle EV charging while maintaining savings.");
            }
            
            // Heat pump insights
            if (answers['10'] === 'have-one' || answers['10'] === 'within-year') {
                insights.push("Heat pumps use substantial electricity, especially in winter. Your system is sized to offset this increased consumption.");
            }
            
            return insights.join(' ');
        }

        // Quote Analyzer Functions
        function initializeQuoteAnalyzer() {
            // System size buttons
            document.querySelectorAll('#system-size-buttons .size-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#system-size-buttons .size-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });

            // Panel output buttons
            document.querySelectorAll('#panel-output-buttons .size-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#panel-output-buttons .size-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });

            // Battery inclusion buttons
            document.querySelectorAll('[data-battery]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-battery]').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const batterySection = document.getElementById('battery-section');
                    if (this.dataset.battery === 'yes') {
                        batterySection.classList.remove('hidden');
                    } else {
                        batterySection.classList.add('hidden');
                    }
                });
            });

            // Battery brand dropdown
            document.getElementById('battery-brand').addEventListener('change', function() {
                const customBattery = document.getElementById('custom-battery');
                if (this.value === 'Other') {
                    customBattery.classList.remove('hidden');
                } else {
                    customBattery.classList.add('hidden');
                }
            });

            // Form submission
            document.getElementById('quote-form').addEventListener('submit', function(e) {
                e.preventDefault();
                analyzeQuote();
            });
        }

        function analyzeQuote() {
            // Get form data
            const systemSize = document.querySelector('#system-size-buttons .size-btn.selected')?.dataset.size;
            const panelOutput = document.querySelector('#panel-output-buttons .size-btn.selected')?.dataset.output;
            const panelBrand = document.getElementById('panel-brand').value;
            const hasBattery = document.querySelector('[data-battery].selected')?.dataset.battery === 'yes';
            const batteryBrand = document.getElementById('battery-brand').value;
            const batteryQuantity = document.getElementById('battery-quantity').value;
            const customBattery = document.getElementById('custom-battery-input').value;
            const quotePrice = parseFloat(document.getElementById('quote-price').value);

            // Validate required fields
            if (!systemSize || !panelOutput || !panelBrand || !quotePrice) {
                alert('Please fill in all required fields');
                return;
            }

            if (hasBattery && !batteryBrand && !customBattery) {
                alert('Please select a battery or specify a custom battery');
                return;
            }

            // Calculate analysis
            const analysis = calculateQuoteAnalysis({
                systemSize: parseFloat(systemSize),
                panelOutput: parseInt(panelOutput),
                panelBrand,
                hasBattery,
                batteryBrand: batteryBrand === 'Other' ? customBattery : batteryBrand,
                batteryQuantity: parseInt(batteryQuantity),
                quotePrice
            });

            // Display results
            displayAnalysisResults(analysis);
        }

        function calculateQuoteAnalysis(quoteData) {
            // Market price calculation
            const basePricePerKW = 1800; // ¬£1800 per kW
            const batteryPricePerKWh = 800; // ¬£800 per kWh
            
            let marketPrice = quoteData.systemSize * basePricePerKW;
            
            if (quoteData.hasBattery) {
                // Estimate battery capacity from brand name
                let batteryCapacity = estimateBatteryCapacity(quoteData.batteryBrand);
                marketPrice += (batteryCapacity * quoteData.batteryQuantity * batteryPricePerKWh);
            }

            // Price assessment
            const priceRatio = quoteData.quotePrice / marketPrice;
            let priceScore, priceEmoji, priceDetails;
            
            if (priceRatio <= 0.9) {
                priceScore = "Excellent";
                priceEmoji = "üü¢";
                priceDetails = "Below market average - great value";
            } else if (priceRatio <= 1.1) {
                priceScore = "Good";
                priceEmoji = "üü°";
                priceDetails = "Around market average - fair price";
            } else if (priceRatio <= 1.3) {
                priceScore = "High";
                priceEmoji = "üü†";
                priceDetails = "Above market average - consider negotiating";
            } else {
                priceScore = "Very High";
                priceEmoji = "üî¥";
                priceDetails = "Significantly overpriced - shop around";
            }

            // Quality assessment
            const qualityRating = assessEquipmentQuality(quoteData.panelBrand, quoteData.batteryBrand);
            
            // Overall value score
            const valueScore = calculateValueScore(priceRatio, qualityRating.score);

            return {
                marketPrice,
                priceRatio,
                priceScore: { score: priceScore, emoji: priceEmoji, details: priceDetails },
                qualityRating,
                valueScore
            };
        }

        function estimateBatteryCapacity(batteryBrand) {
            // Extract capacity from battery brand string
            const capacityMatch = batteryBrand.match(/(\d+\.?\d*)\s*kWh/i);
            if (capacityMatch) {
                return parseFloat(capacityMatch[1]);
            }
            
            // Default estimates for common batteries
            if (batteryBrand.includes('GivEnergy')) return 5.12;
            if (batteryBrand.includes('Fox')) return 5.2;
            if (batteryBrand.includes('Tesla')) return 13.5;
            if (batteryBrand.includes('SolarEdge')) return 10;
            
            return 5; // Default 5kWh
        }

        function assessEquipmentQuality(panelBrand, batteryBrand) {
            // Panel quality ratings
            const panelRatings = {
                'SunPower': 9.5, 'REC': 9.0, 'Panasonic': 9.0, 'LG': 8.5,
                'LONGi': 8.0, 'Jinko Solar': 7.5, 'Trina Solar': 7.5, 'Canadian Solar': 7.5,
                'JA Solar': 7.0, 'Q CELLS': 7.0, 'Risen Energy': 6.5, 'Aiko Solar': 7.0,
                'DMEGC': 6.0, 'Perlight': 6.0, 'Eurener': 6.5, 'Hyundai': 7.0
            };

            // Battery quality ratings
            const batteryRatings = {
                'Tesla': 9.5, 'SolarEdge': 9.0, 'Enphase': 8.5, 'GivEnergy': 8.0,
                'LG Chem': 8.5, 'SolaX': 7.5, 'Fox ESS': 7.0, 'Growatt': 6.5,
                'Huawei': 7.5, 'Sungrow': 7.0, 'Pylontech': 7.0, 'BYD': 7.5
            };

            const panelScore = panelRatings[panelBrand] || 6.0;
            let batteryScore = 7.0; // Default if no battery
            
            if (batteryBrand) {
                // Find matching battery rating
                for (const [brand, rating] of Object.entries(batteryRatings)) {
                    if (batteryBrand.includes(brand)) {
                        batteryScore = rating;
                        break;
                    }
                }
            }

            const overallScore = batteryBrand ? (panelScore + batteryScore) / 2 : panelScore;
            
            let verdict, emoji;
            if (overallScore >= 8.5) {
                verdict = "Excellent";
                emoji = "‚≠ê";
            } else if (overallScore >= 7.5) {
                verdict = "Good";
                emoji = "üëç";
            } else if (overallScore >= 6.5) {
                verdict = "Okay";
                emoji = "üëå";
            } else {
                verdict = "Poor";
                emoji = "üëé";
            }

            return {
                score: overallScore,
                verdict,
                emoji,
                details: `Panel: ${panelScore}/10, Battery: ${batteryScore}/10`
            };
        }

        function calculateValueScore(priceRatio, qualityScore) {
            // Value score combines price and quality
            let priceScore = 10;
            if (priceRatio > 1.1) priceScore = Math.max(1, 10 - (priceRatio - 1.1) * 20);
            
            const valueScore = (priceScore + qualityScore) / 2;
            
            let emoji, details;
            if (valueScore >= 8.5) {
                emoji = "üéØ";
                details = "Excellent value for money";
            } else if (valueScore >= 7.0) {
                emoji = "üëç";
                details = "Good value overall";
            } else if (valueScore >= 5.5) {
                emoji = "üëå";
                details = "Acceptable value";
            } else {
                emoji = "üëé";
                details = "Poor value - consider alternatives";
            }

            return {
                score: Math.round(valueScore * 10) / 10,
                emoji,
                details
            };
        }

        function displayAnalysisResults(analysis) {
            // Update price score
            document.getElementById('price-emoji').textContent = analysis.priceScore.emoji;
            document.getElementById('price-score').textContent = analysis.priceScore.score;
            
            // Update quality score
            document.getElementById('quality-emoji').textContent = analysis.qualityRating.emoji;
            document.getElementById('quality-score').textContent = analysis.qualityRating.verdict;
            
            // Update value score
            document.getElementById('value-emoji').textContent = analysis.valueScore.emoji;
            document.getElementById('value-score').textContent = analysis.valueScore.score + '/10';
            document.getElementById('value-details').textContent = analysis.valueScore.details;
            
            // Generate insights, considerations, and recommendations
            updateAnalysisContent(analysis);
            
            // Show results
            document.getElementById('analysis-results').classList.remove('hidden');
            document.getElementById('analysis-results').scrollIntoView({ behavior: 'smooth' });
        }

        function updateAnalysisContent(analysis) {
            // Key insights
            const insights = [
                `Quote price is ${analysis.priceRatio > 1 ? 'above' : 'below'} market average`,
                `Panel quality is ${analysis.qualityRating.verdict.toLowerCase()}`,
                `Overall value score: ${analysis.valueScore.score}/10`
            ];
            
            if (analysis.priceRatio < 1.1 && analysis.priceRatio > 0.9) {
                insights.push('Price is competitive for current market');
            }
            
            document.getElementById('key-insights').innerHTML = insights.map(insight => `<li>‚Ä¢ ${insight}</li>`).join('');
            
            // Considerations
            const considerations = [
                'Get quotes from 2-3 other installers for comparison',
                'Verify installer is MCS certified',
                'Check warranty terms and conditions',
                'Confirm installation timeline and payment schedule'
            ];
            
            if (analysis.priceRatio > 1.15) {
                considerations.unshift('Price is above market average - consider negotiating');
            }
            
            document.getElementById('considerations').innerHTML = considerations.map(consideration => `<li>‚Ä¢ ${consideration}</li>`).join('');
            
            // Recommendations
            let recommendations = [];
            
            if (analysis.valueScore.score >= 7.5) {
                recommendations.push('This quote represents good value for money');
                recommendations.push('Consider proceeding with this installer');
            } else if (analysis.valueScore.score >= 5) {
                recommendations.push('This quote is acceptable but shop around');
                recommendations.push('Try to negotiate a better price');
            } else {
                recommendations.push('This quote offers poor value');
                recommendations.push('Strongly recommend getting other quotes');
            }
            
            recommendations.push('Negotiate payment terms if needed');
            recommendations.push('Schedule installation for optimal timing');
            
            document.getElementById('recommendations').innerHTML = recommendations.map(rec => `<li>‚Ä¢ ${rec}</li>`).join('');
        }

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Scroll functions
        function scrollToConsultation() {
            document.getElementById('consultation').scrollIntoView({ behavior: 'smooth' });
        }

        function scrollToAnalyzer() {
            document.getElementById('analyzer').scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeConsultation();
            initializeQuoteAnalyzer();
        });
    </script>
</body>
</html>

